!function(b,R){"use strict";function v(b,v,m){u("ht."+b,v,m)}function $(b,v,m){m?b.push(v.x,v.y):b.push(v.x,v.y,v.z)}function O(X,b,v){var m,x=X.data.getAttaches();if(x&&x.each(function(b){b instanceof f&&b.s("attach.operation")&&(m=m||[]).push(b)}),m){H.forEach(function(b){b=function(b,v,m,x){var S,a,p,L,e=0,R=[];if(x)for(S=x.length;e<S;e+=3)a=x[e],p=x[e+1],L=x[e+2],j(R,new D([v[3*a],v[3*a+1],v[3*a+2]],null,m?[m[2*a],m[2*a+1],0]:V),new D([v[3*p],v[3*p+1],v[3*p+2]],null,m?[m[2*p],m[2*p+1],0]:V),new D([v[3*L],v[3*L+1],v[3*L+2]],null,m?[m[2*L],m[2*L+1],0]:V),b);else for(S=v.length/3;e<S;e+=3)p=(a=e)+1,L=e+2,j(R,new D([v[3*a],v[3*a+1],v[3*a+2]],null,m?[m[2*a],m[2*a+1],0]:V),new D([v[3*p],v[3*p+1],v[3*p+2]],null,m?[m[2*p],m[2*p+1],0]:V),new D([v[3*L],v[3*L+1],v[3*L+2]],null,m?[m[2*L],m[2*L+1],0]:V),b);return R}(b,X[b].vs,X[b].tuv);S=S?S.concat(b):b}),S=I.$15n(S),m.forEach(function(b){var v=b.s("attach.operation");S[v]&&(S=S[v](function(b,v,m){var x,S=t(b),a=[],p=(b.appendAnchorMatrix3d(S),v?v.getData3dUI(b):null);if(p&&p.s("shape3d")&&!p.s("csg.cull.box")&&(x=p.shapeModel,x=p.shapeModel?x:C.getShapeModel(p,p.s("shape3d"))))for(var L=C.createNormalMatrix(S),e=0,R=et.length;e<R;e++){var X=(F=et[e]).length?F+"_":F,W=x[X+"vs"],$=x[X+"uv"],g=x[X+"is"],P=x[X+"ns"];if(W&&W.length)for(var A,B,_,K=0,s=g?g.length:W.length/3;K<s;K+=3)_=g?(A=g[K],B=g[K+1],g[K+2]):(B=(A=K)+1,K+2),j(a,new D(k([W[3*A],W[3*A+1],W[3*A+2]],S),P?k([P[3*A],P[3*A+1],P[3*A+2]],L):null,[$[2*A],$[2*A+1],0]),new D(k([W[3*B],W[3*B+1],W[3*B+2]],S),P?k([P[3*B],P[3*B+1],P[3*B+2]],L):null,[$[2*B],$[2*B+1],0]),new D(k([W[3*_],W[3*_+1],W[3*_+2]],S),P?k([P[3*_],P[3*_+1],P[3*_+2]],L):null,[$[2*_],$[2*_+1],0]),b)}if(!x)for(e=0;e<6;e++)for(var F=H[e],q=Xt[e],$=m?v.getFaceUv(b,F):V,J=m?v.getFaceUvScale(b,F):V,Y=m?v.getFaceUvOffset(b,F):V,f=0;f<2;f++){var w,O,r,l=c[q+3*f],h=c[q+3*f+1],E=c[q+3*f+2];m&&(r=$?(w=[$[2*l-(r=8*e)],$[2*l+1-r],0],O=[$[2*h-r],$[2*h+1-r],0],[$[2*E-r],$[2*E+1-r],0]):(w=[z[2*l],z[2*l+1],0],O=[z[2*h],z[2*h+1],0],[z[2*E],z[2*E+1],0]),J&&(w[0]*=J[0],w[1]*=J[1],O[0]*=J[0],O[1]*=J[1],r[0]*=J[0],r[1]*=J[1]),Y&&(w[0]+=Y[0],w[1]+=Y[1],O[0]+=Y[0],O[1]+=Y[1],r[0]+=Y[0],r[1]+=Y[1])),j(a,new D(k([i[3*l],i[3*l+1],i[3*l+2]],S),null,w),new D(k([i[3*h],i[3*h+1],i[3*h+2]],S),null,O),new D(k([i[3*E],i[3*E+1],i[3*E+2]],S),null,r),b)}return I.$15n(a)}(b,X.gv,X.csg.tuv)))}),H.forEach(function(b){(b=X[b]).vs=[],b.ns=[],b.tuv&&(b.tuv=[])}),X.csg&&!X.csg.ns&&(X.csg.ns=[]);var S,W=[];if(S.$19n().forEach(function(b){var v,m=b.$10n;if(m instanceof f){if(m.s("attach.cull"))return;v=(v=m.s("csg.cull.color"))&&C.toColorArray(v),m="csg"}for(var m=X[m],x=m.vs,S=m.ns,a=m.tuv,p=b.$9n,L=2;L<p.length;L++)if($(x,p[0].$24n),$(x,p[L-1].$24n),$(x,p[L].$24n),S&&($(S,p[0].$22n),$(S,p[L-1].$22n),$(S,p[L].$22n)),a&&($(a,p[0].uv,!0),$(a,p[L-1].uv,!0),$(a,p[L].uv,!0)),v)for(var e=x.length/3*4,R=0;R<3;R++)W[--e]=v[3],W[--e]=v[2],W[--e]=v[1],W[--e]=v[0]}),W.length){for(var a=C.toColorArray(X.csg.color),p=0,L=X.csg.vs.length/3*4;p<L;p+=4)W[p]==R&&(W[p]=a[0],W[p+1]=a[1],W[p+2]=a[2],W[p+3]=a[3]);X.csg.cs=W}}Rt.forEach(function(b){var v=X[b];v.visible&&v.vs.length?(v.ns&&v.ns.length?g(v,"ns"):v.ns=n(v.vs),g(v,"vs"),g(v,"tuv"),v.cs&&g(v,"cs")):delete X[b]}),b&&(y(X,V,b,V,v),X.clear())}function x(b,v){this.$22n=b,this.w=v}function r(b,v,m,x,$){var S=[],a=[],p=[],L=new s;if((b=b.getData3dUI(v)).mat){var e,X=(new F).fromArray(b.mat),v=new F,W=(v.makeRotationFromEuler(x),v.setPosition(m),(new F).getInverse(v)),R=(new F).scale({x:1/$.x,y:1/$.y,z:1/$.z}),g=[],P=new s,A=new s;for(b.eachShapeModel(function(b,v,m,x,S){for(var a,p,L,e=0,R=v?v.length:b.length/3;e<R;e++)v?(P.fromArray(b,3*v[e]),A.fromArray(m,3*v[e])):(P.fromArray(b,3*e),A.fromArray(m,3*e)),S&&(P.applyMatrix4(S),A.transformDirection(S)),a=g,L=A,(p=P).applyMatrix4(X),p.applyMatrix4(W),L.transformDirection(X),L.transformDirection(W),a.push(new _t(p.clone(),L.clone()))}),g=_(g,L.set(1,0,0)),g=_(g,L.set(-1,0,0)),g=_(g,L.set(0,1,0)),g=_(g,L.set(0,-1,0)),g=_(g,L.set(0,0,1)),g=_(g,L.set(0,0,-1)),e=0;e<g.length;e++){var B=g[e];p.push(.5+B.position.x/$.x,.5-B.position.y/$.y),B.position.applyMatrix4(R),S.push(B.position.x,B.position.y,B.position.z),a.push(B.$22n.x,B.$22n.y,B.$22n.z)}return{vs:S,ns:a,uv:p}}function _(b,v){for(var m=[],x=.5*Math.abs($.dot(v)),S=0;S<b.length;S+=3){var a,p,L,e,R=0<b[S+0].position.dot(v)-x,X=0<b[S+1].position.dot(v)-x,W=0<b[S+2].position.dot(v)-x;switch((R?1:0)+(X?1:0)+(W?1:0)){case 0:m.push(b[S]),m.push(b[S+1]),m.push(b[S+2]);break;case 1:if(R&&(a=b[S+1],p=b[S+2],L=K(b[S],a,v,x),e=K(b[S],p,v,x)),X){a=b[S],p=b[S+2],L=K(b[S+1],a,v,x),e=K(b[S+1],p,v,x),m.push(L),m.push(p.clone()),m.push(a.clone()),m.push(p.clone()),m.push(L.clone()),m.push(e);break}W&&(a=b[S],p=b[S+1],L=K(b[S+2],a,v,x),e=K(b[S+2],p,v,x)),m.push(a.clone()),m.push(p.clone()),m.push(L),m.push(e),m.push(L.clone()),m.push(p.clone());break;case 2:R||(p=K(a=b[S].clone(),b[S+1],v,x),L=K(a,b[S+2],v,x),m.push(a),m.push(p),m.push(L)),X||(p=K(a=b[S+1].clone(),b[S+2],v,x),L=K(a,b[S],v,x),m.push(a),m.push(p),m.push(L)),W||(p=K(a=b[S+2].clone(),b[S],v,x),L=K(a,b[S+1],v,x),m.push(a),m.push(p),m.push(L))}}return m}function K(b,v,m,x){var S=b.position.dot(m)-x,S=S/(S-(v.position.dot(m)-x));return new _t(new s(b.position.x+S*(v.position.x-b.position.x),b.position.y+S*(v.position.y-b.position.y),b.position.z+S*(v.position.z-b.position.z)),new s(b.$22n.x+S*(v.$22n.x-b.$22n.x),b.$22n.y+S*(v.$22n.y-b.$22n.y),b.$22n.z+S*(v.$22n.z-b.$22n.z)))}}var p,L,e,X=b.ht,V=null,b=Math,B=b.PI,l=b.cos,_=b.sin,h=b.abs,E=b.max,o=b.sqrt,U=1e-5,a=X.Default,u=a.def,N=a.startAnim,T=a.createMatrix,k=a.transformVec,C=a.getInternal(),m=C.addMethod,S=C.superCall,Z=C.toPointsArray,n=C.createNormals,g=C.toFloatArray,G=C.glMV,b=(C.glPop,X.graph3d.Graph3dView,X.Math),s=b.Vector3,F=b.Matrix4,M=b.Euler,y=(b.Quaternion,C.batchShape),t=C.createNodeMatrix,Q=C.getFaceInfo,d=C.transformAppend,bt=C.drawFaceInfo,vt=C.createAnim,b=C.cube(),c=b.is,i=b.vs,z=b.uv,b=C.ui(),mt=X.Node,xt=X.Shape,St="left",at="right",pt="top",Lt="bottom",W="dw.expanded",P=".expanded",A="dw.angle",K=".angle",j=(p=new X.Math.Vector3,L=new X.Math.Vector3,e=new X.Math.Vector3,function(b,v,m,x,S){var a;p.copy(v.$24n),L.copy(m.$24n),e.copy(x.$24n),e.equals(p)||L.equals(p)||L.equals(e)||(v.$22n&&m.$22n&&x.$22n||(a=L.sub(p).cross(e.sub(p)).normalize().multiplyScalar(1).toArray(),v.$22n||(v.$22n=new q(a)),m.$22n||(m.$22n=new q(a)),x.$22n||(x.$22n=new q(a))),b.push(new J([v,m,x],S)))}),H=[St,"front",at,"back",pt,Lt],et=["",pt,Lt],Rt=H.concat("csg"),Xt=[0,6,12,18,24,30],I=(m(a,{createFrameModel:function(b,v,m,x){b=b==V?.07:b,v=v==V?b:v,m=m==V?b:m;var S=(x=x||{}).top,a=x.bottom,p=x.left,L=x.right,e=x.front,x=x.back,R=[],X=[];return!0===e?(R.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),X.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==e&&(R.push(-.5,.5,.5,-.5,-.5,.5,-.5+b,-.5,.5,-.5+b,-.5,.5,-.5+b,.5,.5,-.5,.5,.5,.5-b,.5,.5,.5-b,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-b,.5,.5,-.5+b,.5,.5,-.5+b,.5-v,.5,.5-b,.5-v,.5,.5-b,.5-v,.5,.5-b,.5,.5,-.5+b,.5,.5,-.5+b,-.5+v,.5,-.5+b,-.5,.5,.5-b,-.5,.5,.5-b,-.5,.5,.5-b,-.5+v,.5,-.5+b,-.5+v,.5),X.push(0,0,0,1,b,1,b,1,b,0,0,0,1-b,0,1-b,1,1,1,1,1,1,0,1-b,0,b,0,b,v,1-b,v,1-b,v,1-b,0,b,0,b,1-v,b,1,1-b,1,1-b,1,1-b,1-v,b,1-v)),!0===x?(R.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),X.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==x&&(R.push(-.5,.5,-.5,-.5+b,-.5,-.5,-.5,-.5,-.5,-.5+b,-.5,-.5,-.5,.5,-.5,-.5+b,.5,-.5,.5-b,.5,-.5,.5,-.5,-.5,.5-b,-.5,-.5,.5,-.5,-.5,.5-b,.5,-.5,.5,.5,-.5,-.5+b,.5,-.5,.5-b,.5-v,-.5,-.5+b,.5-v,-.5,.5-b,.5-v,-.5,-.5+b,.5,-.5,.5-b,.5,-.5,-.5+b,-.5+v,-.5,.5-b,-.5,-.5,-.5+b,-.5,-.5,.5-b,-.5,-.5,-.5+b,-.5+v,-.5,.5-b,-.5+v,-.5),X.push(1,0,1-b,1,1,1,1-b,1,1,0,1-b,0,b,0,0,1,b,1,0,1,b,0,0,0,1-b,0,b,v,1-b,v,b,v,1-b,0,b,0,1-b,1-v,b,1,1-b,1,b,1,1-b,1-v,b,1-v)),!0===p?(R.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),X.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==p&&(R.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+m,-.5,-.5,-.5+m,-.5,.5,-.5+m,-.5,.5,-.5,-.5,.5,.5-m,-.5,-.5,.5-m,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-m,-.5,.5,-.5+m,-.5,.5-v,-.5+m,-.5,.5-v,.5-m,-.5,.5-v,.5-m,-.5,.5,.5-m,-.5,.5,-.5+m,-.5,-.5+v,-.5+m,-.5,-.5,-.5+m,-.5,-.5,.5-m,-.5,-.5,.5-m,-.5,-.5+v,.5-m,-.5,-.5+v,-.5+m),X.push(0,0,0,1,m,1,m,1,m,0,0,0,1-m,0,1-m,1,1,1,1,1,1,0,1-m,0,m,0,m,v,1-m,v,1-m,v,1-m,0,m,0,m,1-v,m,1,1-m,1,1-m,1,1-m,1-v,m,1-v)),!0===L?(R.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),X.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==L&&(R.push(.5,.5,-.5,.5,-.5,-.5+m,.5,-.5,-.5,.5,-.5,-.5+m,.5,.5,-.5,.5,.5,-.5+m,.5,.5,.5-m,.5,-.5,.5,.5,-.5,.5-m,.5,-.5,.5,.5,.5,.5-m,.5,.5,.5,.5,.5,-.5+m,.5,.5-v,.5-m,.5,.5-v,-.5+m,.5,.5-v,.5-m,.5,.5,-.5+m,.5,.5,.5-m,.5,-.5+v,-.5+m,.5,-.5,.5-m,.5,-.5,-.5+m,.5,-.5,.5-m,.5,-.5+v,-.5+m,.5,-.5+v,.5-m),X.push(1,0,1-m,1,1,1,1-m,1,1,0,1-m,0,m,0,0,1,m,1,0,1,m,0,0,0,1-m,0,m,v,1-m,v,m,v,1-m,0,m,0,1-m,1-v,m,1,1-m,1,m,1,1-m,1-v,m,1-v)),!0===S?(R.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),X.push(1,1,1,0,0,0,0,0,0,1,1,1)):!1!==S&&(R.push(.5,.5,.5,.5,.5,-.5,.5-b,.5,-.5,.5-b,.5,-.5,.5-b,.5,.5,.5,.5,.5,-.5+b,.5,.5,-.5+b,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+b,.5,.5,.5-b,.5,.5,.5-b,.5,.5-m,-.5+b,.5,.5-m,-.5+b,.5,.5-m,-.5+b,.5,.5,.5-b,.5,.5,.5-b,.5,-.5+m,.5-b,.5,-.5,-.5+b,.5,-.5,-.5+b,.5,-.5,-.5+b,.5,-.5+m,.5-b,.5,-.5+m),X.push(1,1,1,0,1-b,0,1-b,0,1-b,1,1,1,b,1,b,0,0,0,0,0,0,1,b,1,1-b,1,1-b,1-m,b,1-m,b,1-m,b,1,1-b,1,1-b,m,1-b,0,b,0,b,0,b,m,1-b,m)),!0===a?(R.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),X.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==a&&(R.push(.5,-.5,.5,.5-b,-.5,-.5,.5,-.5,-.5,.5-b,-.5,-.5,.5,-.5,.5,.5-b,-.5,.5,-.5+b,-.5,.5,-.5,-.5,-.5,-.5+b,-.5,-.5,-.5,-.5,-.5,-.5+b,-.5,.5,-.5,-.5,.5,.5-b,-.5,.5,-.5+b,-.5,.5-m,.5-b,-.5,.5-m,-.5+b,-.5,.5-m,.5-b,-.5,.5,-.5+b,-.5,.5,.5-b,-.5,-.5+m,-.5+b,-.5,-.5,.5-b,-.5,-.5,-.5+b,-.5,-.5,.5-b,-.5,-.5+m,-.5+b,-.5,-.5+m),X.push(1,0,1-b,1,1,1,1-b,1,1,0,1-b,0,b,0,0,1,b,1,0,1,b,0,0,0,1-b,0,b,m,1-b,m,b,m,1-b,0,b,0,1-b,1-m,b,1,1-b,1,b,1,1-b,1-m,b,1-m)),{vs:R,uv:X}}}),m(X.Style,{"csg.cull.color":R,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":R,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":B/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),H.forEach(function(b){var v={};v[b+P]=!1,v[b+".toggleable"]=!1,v[b+".axis"]=St,v[b+".start"]=0,v[b+".end"]=B/2,v[b+K]=0,m(X.Style,v,!0)}),function(){this.$4n=[]}),q=(I.$15n=function(b){var v=new I;return v.$4n=b,v},I.prototype={clone:function(){var b=new I;return b.$4n=this.$4n.map(function(b){return b.clone()}),b},$19n:function(){return this.$4n},union:function(b){var v=new Y(this.clone().$4n),b=new Y(b.clone().$4n);return v.$3n(b),b.$3n(v),b.$6n(),b.$3n(v),b.$6n(),v.$7n(b.$2n()),I.$15n(v.$2n())},subtract:function(b){var v=new Y(this.clone().$4n),b=new Y(b.clone().$4n);return v.$6n(),v.$3n(b),b.$3n(v),b.$6n(),b.$3n(v),b.$6n(),v.$7n(b.$2n()),v.$6n(),I.$15n(v.$2n())},intersect:function(b){var v=new Y(this.clone().$4n),b=new Y(b.clone().$4n);return v.$6n(),b.$3n(v),b.$6n(),v.$3n(b),b.$3n(v),v.$7n(b.$2n()),v.$6n(),I.$15n(v.$2n())},inverse:function(){var b=this.clone();return b.$4n.map(function(b){b.flip()}),b}},I.cube=function(b){var m=new q((b=b||{}).center||[0,0,0]),x=b.radius?b.radius.length?b.radius:[b.radius,b.radius,b.radius]:[1,1,1];return I.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(v){return new J(v[0].map(function(b){b=new q(m.x+x[0]*(2*!!(1&b)-1),m.y+x[1]*(2*!!(2&b)-1),m.z+x[2]*(2*!!(4&b)-1));return new D(b,new q(v[1]))}))}))},I.sphere=function(b){var m,x=new q((b=b||{}).center||[0,0,0]),S=b.radius||1,v=b.slices||16,a=b.stacks||8,p=[];function L(b,v){v*=B;b=new q(l(b*=2*B)*_(v),l(v),_(b)*_(v));m.push(new D(x.$20n(b.$21n(S)),b))}for(var e=0;e<v;e++)for(var R=0;R<a;R++)m=[],L(e/v,R/a),0<R&&L((e+1)/v,R/a),R<a-1&&L((e+1)/v,(R+1)/a),L(e/v,(R+1)/a),p.push(new J(m));return I.$15n(p)},I.cylinder=function(b){var x=new q((b=b||{}).start||[0,-1,0]),v=new q(b.end||[0,1,0]),S=v.$13n(x),a=b.radius||1,m=b.slices||16,p=S.$14n(),b=.5<h(p.y),L=new q(b,!b,0).cross(p).$14n(),e=L.cross(p).$14n(),R=new D(x,p.$11n()),X=new D(v,p.$14n()),W=[];function $(b,v,m){v=v*B*2,v=L.$21n(l(v)).$20n(e.$21n(_(v))),b=x.$20n(S.$21n(b)).$20n(v.$21n(a)),v=v.$21n(1-h(m)).$20n(p.$21n(m));return new D(b,v)}for(var g=0;g<m;g++){var P=g/m,A=(g+1)/m;W.push(new J([R,$(0,P,-1),$(0,A,-1)])),W.push(new J([$(0,A,0),$(0,P,0),$(1,P,0),$(1,A,0)])),W.push(new J([X,$(1,A,1),$(1,P,1)]))}return I.$15n(W)},function(b,v,m){var x=this;3==arguments.length?(x.x=b,x.y=v,x.z=m):"x"in b?(x.x=b.x,x.y=b.y,x.z=b.z):(x.x=b[0],x.y=b[1],x.z=b[2])}),D=(q.prototype={clone:function(){return new q(this.x,this.y,this.z)},$11n:function(){return new q(-this.x,-this.y,-this.z)},$20n:function(b){return new q(this.x+b.x,this.y+b.y,this.z+b.z)},$13n:function(b){return new q(this.x-b.x,this.y-b.y,this.z-b.z)},$21n:function(b){return new q(this.x*b,this.y*b,this.z*b)},$16n:function(b){return new q(this.x/b,this.y/b,this.z/b)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},lerp:function(b,v){return this.$20n(b.$13n(this).$21n(v))},length:function(){return o(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(b){var v=this;return new q(v.y*b.z-v.z*b.y,v.z*b.x-v.x*b.z,v.x*b.y-v.y*b.x)}},function(b,v,m){this.$24n=new q(b),this.$22n=v?new q(v):null,this.uv=m?new q(m):null}),J=(D.prototype={clone:function(){return new D(this.$24n.clone(),this.$22n.clone(),this.uv?this.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(b,v){return new D(this.$24n.lerp(b.$24n,v),this.$22n.lerp(b.$22n,v),this.uv?this.uv.lerp(b.uv,v):null)}},x.$17n=function(b,v,m){v=v.$13n(b).cross(m.$13n(b)).$14n();return new x(v,v.dot(b))},x.prototype={clone:function(){return new x(this.$22n.clone(),this.w)},flip:function(){this.$22n=this.$22n.$11n(),this.w=-this.w},$5n:function(b,v,m,x,S){for(var a=this,p=0,L=[],e=0;e<b.$9n.length;e++){var R=($=a.$22n.dot(b.$9n[e].$24n)-a.w)<-U?2:U<$?1:0;p|=R,L.push(R)}switch(p){case 0:(0<a.$22n.dot(b.$8n.$22n)?v:m).push(b);break;case 1:x.push(b);break;case 2:S.push(b);break;case 3:for(var X=[],W=[],e=0;e<b.$9n.length;e++){var $,g=(e+1)%b.$9n.length,P=L[e],A=L[g],B=b.$9n[e],g=b.$9n[g];2!=P&&X.push(B),1!=P&&W.push(2!=P?B.clone():B),3==(P|A)&&($=(a.w-this.$22n.dot(B.$24n))/a.$22n.dot(g.$24n.$13n(B.$24n)),P=B.$18n(g,$),X.push(P),W.push(P.clone()))}3<=X.length&&x.push(new J(X,b.$10n)),3<=W.length&&S.push(new J(W,b.$10n))}}},function(b,v){this.$9n=b,this.$10n=v,this.$8n=x.$17n(b[0].$24n,b[1].$24n,b[2].$24n)}),Y=(J.prototype={clone:function(){var b=this.$9n.map(function(b){return b.clone()});return new J(b,this.$10n)},flip:function(){this.$9n.reverse().map(function(b){b.flip()}),this.$8n.flip()}},function(b){var v=this;v.$8n=null,v.front=null,v.back=null,v.$4n=[],b&&v.$7n(b)}),Wt=(Y.prototype={clone:function(){var b=this,v=new Y;return v.$8n=b.$8n&&b.$8n.clone(),v.front=b.front&&b.front.clone(),v.back=b.back&&b.back.clone(),v.$4n=b.$4n.map(function(b){return b.clone()}),v},$6n:function(){for(var b=this,v=0;v<b.$4n.length;v++)b.$4n[v].flip();b.$8n&&b.$8n.flip(),b.front&&b.front.$6n(),b.back&&b.back.$6n();var m=b.front;b.front=b.back,b.back=m},$1n:function(b){var v=this;if(!v.$8n)return b.slice();for(var m=[],x=[],S=0;S<b.length;S++)v.$8n.$5n(b[S],m,x,m,x);return v.front&&(m=v.front.$1n(m)),x=v.back?v.back.$1n(x):[],m.concat(x)},$3n:function(b){var v=this;v.$4n=b.$1n(v.$4n),v.front&&v.front.$3n(b),v.back&&v.back.$3n(b)},$2n:function(){var b=this,v=b.$4n.slice();return b.front&&(v=v.concat(b.front.$2n())),v=b.back?v.concat(b.back.$2n()):v},$7n:function(b){var v=this;if(b.length){v.$8n||(v.$8n=b[0].$8n.clone());for(var m=[],x=[],S=0;S<b.length;S++)this.$8n.$5n(b[S],v.$4n,v.$4n,m,x);m.length&&(v.front||(v.front=new Y),this.front.$7n(m)),x.length&&(v.back||(v.back=new Y),v.back.$7n(x))}}},X.Symbol=function(b,v,m){S(Wt,this),this.s3(20,20,20),this.s({"all.visible":!1,shape:"rect"}),this.setIcon(b,v,m)}),f=(v("Symbol",mt,{setIcon:function(b,v,m){var x,S=this;return Wt.superClass.setIcon.call(S,b),b?(x={for3d:!0,face:"center",position:44,names:[b]},m&&(x.transaprent=!0),v&&(x.autorotate=v),S.addStyleIcon("symbol",x)):S.removeStyleIcon("symbol"),S.setWidth(C.getImageWidth(a.getImage(b),S)||20),x}}),X.CSGNode=function(){S(f,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})}),$t={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1},w=(v("CSGNode",mt,{get3dUIClass:function(){return w},onPropertyChanged:function(b){var v=this.getHost();f.superClass.onPropertyChanged.call(this,b),$t[b.property]&&(v instanceof gt||v instanceof f)&&v.fp("csgNodeChange",!0,!1)}}),function(b,v){S(w,this,[b,v])}),gt=(u(w,b.Node3dUI,{drawBody:function(v,m,x){var S=this;S._shape3d?w.superClass.drawBody.call(S,v,m,x):(G(S.gv),Rt.forEach(function(b){bt(S,v,m,b,x)}))},validate:function(b,v){var m=this,x=m.gv,S=m.data;if(S.s("shape3d"))return w.superClass.validate.call(m,b,v),void(m._shape3d=!0);m._shape3d=!1;var a=t(S,x.getMat(S)),p=(S.appendAnchorMatrix3d(a),b&&b.uv);m.vf2("csg",p);for(var L=0;L<6;L++)for(var e=H[L],R=Xt[L],e=m.vf2(e,p,v),X=e.mat||a,W=e.vs,$=e.uv,g=e.tuv,P=0;P<2;P++){var A,B=c[R+3*P],_=c[R+3*P+1],K=c[R+3*P+2];d(W,X,[i[3*B],i[3*B+1],i[3*B+2]]),d(W,X,[i[3*_],i[3*_+1],i[3*_+2]]),d(W,X,[i[3*K],i[3*K+1],i[3*K+2]]),g&&($?g.push($[2*B-(A=8*L)],$[2*B+1-A],$[2*_-A],$[2*_+1-A],$[2*K-A],$[2*K+1-A]):g.push(z[2*B],z[2*B+1],z[2*_],z[2*_+1],z[2*K],z[2*K+1]))}O(m,b,v)},vf2:function(b,v,m){var x=this.gv.getFaceVisible(this.data,b),b=Q(this,b,m);return b.vs=[],b.tuv=x&&(b.texture||v)?[]:V,b.visible=x,b}}),X.CSGShape=function(){var b=this;S(gt,b),b.s({"shape.background":V,"2d.hostable":!0,"shape.border.width":8}),b.setTall(240),b.setElevation(120),b.setThickness(14)}),Pt=(v("CSGShape",xt,{IRotatable:!1,get3dUIClass:function(){return Pt},setRotationX:function(b){},setRotation:function(b){},setRotationZ:function(b){},setSegments:function(b){}}),function(b,v){S(Pt,this,[b,v])}),At=(u(Pt,b.Shape3dUI,{drawBody:function(v,m,x){var S=this;S.undrawable||(G(S.gv),Rt.forEach(function(b){bt(S,v,m,b,x)}))},validate:function(v,m){var b,x,S,a,p=this,L=p.data,e=L.getPoints();(p.undrawable=e.size()<2)?p.clear():(b=L.isClosePath(),x=E(L._thickness/2,U),e=Z(e,V,V,b),Rt.forEach(function(b){p.vf(b,v&&v.uv,!0,m)}),b&&(p.left.visible=!1,p.right.visible=!1),p._12O(e,x),p._20Q(e),S=L.getPointsMatrix3d(),a=X.Math.requestVector3(),H.forEach(function(b){if(p[b])for(var v=p[b].vs,m=0,x=v.length;m<x;m+=3)a.set(v[m],v[m+1],v[m+2]).applyMatrix4(S),v[m]=a.x,v[m+1]=a.y,v[m+2]=a.z}),X.Math.releaseVector3(a),O(p,v,m))}}),X.DoorWindow=function(){S(At,this),this.setElevation(100),this.s3(100,200,14)}),Bt=(v("DoorWindow",f,{IDoorWindow:!0,toggle:function(b){this.setExpanded(!this.s(W),b)},isExpanded:function(){return this.s(W)},setExpanded:function(b,v){var m,x=this,S=x.$25n,a=x.s(W);S&&(S.stop(!0),delete x.$25n),a!==b&&(x.beginTransaction(),m=b?x.s("dw.end"):x.s("dw.start"),x.s(W,b),(v=vt(v))?(a=x.s(A),v.action=function(b){x.s(A,a+(m-a)*b)},v.finishFunc=function(){x.endTransaction()},x.$25n=N(v)):(x.s(A,m),x.endTransaction()))},getMat:function(){var b,v,m=this,x=m.s("dw.s3"),S=m.s("dw.t3"),a=m.s("dw.flip"),p=m.s(A);return x||p||S||a?(b=[],a&&b.push({r3:[0,B,0]}),x&&b.push({s3:x}),p&&(x=m.getFinalScale3d(),a=m.s("dw.axis"),m=x[0]/2,v=x[1]/2,x[2],a===St?b.push({t3:[m,0,0]},{r3:[0,-p,0]},{t3:[-m,0,0]}):a===at?b.push({t3:[-m,0,0]},{r3:[0,p,0]},{t3:[m,0,0]}):a===pt?b.push({t3:[0,-v,0]},{r3:[-p,0,0]},{t3:[0,v,0]}):a===Lt?b.push({t3:[0,v,0]},{r3:[p,0,0]},{t3:[0,-v,0]}):"v"===a?b.push({r3:[0,p,0]}):"h"===a&&b.push({r3:[p,0,0]})),S&&b.push({t3:S}),T(b)):V}}),X.CSGBox=function(){S(Bt,this),this.setElevation(100),this.s3(100,200,100)});v("CSGBox",f,{ICSGBox:!0,toggleFace:function(b,v){this.setFaceExpanded(b,!this.s(b+P),v)},isFaceExpanded:function(b){return this.s(b+P)},setFaceExpanded:function(v,b,m){var x,S=this,a=S.$25n,p=S.s(v+P);a&&(a.stop(!0),delete S.$25n),p!==b&&(x=b?S.s(v+".end"):S.s(v+".start"),S.s(v+P,b),(m=vt(m))?(p=S.s(v+K),m.action=function(b){S.s(v+K,p+(x-p)*b)},S.$25n=N(m)):S.s(v+K,x))},getFaceMat:function(b){var v=this.s(b+K);if(!v)return V;var m,x,S,a,p,L,e=this.s(b+".axis"),R=this.getFinalScale3d(),X=this.getAnchor3d(),W=R[0]*X.x,$=R[1]*X.y,g=R[2]*X.z,P=R[0]-W,A=R[1]-$,B=R[2]-g;switch(b+"_"+e){case"front_left":m=-W,S=B,p=-v,L=a=x=0;break;case"front_right":m=P,S=B,p=v,L=a=x=0;break;case"front_top":x=A,S=B,a=-v,L=p=m=0;break;case"front_bottom":x=-$,S=B,a=v,L=p=m=0;break;case"front_h":S=B,a=v,L=p=x=m=0;break;case"front_v":S=B,p=v,L=a=x=m=0;break;case"back_left":m=P,S=-g,p=-v,L=a=x=0;break;case"back_right":m=-W,S=-g,p=v,L=a=x=0;break;case"back_top":x=A,S=-g,a=v,L=p=m=0;break;case"back_bottom":x=-$,S=-g,a=-v,L=p=m=0;break;case"back_h":S=-g,a=v,L=p=x=m=0;break;case"back_v":S=-g,p=v,L=a=x=m=0;break;case"left_left":m=-W,S=-g,p=-v,L=a=x=0;break;case"left_right":m=-W,S=B,p=v,L=a=x=0;break;case"left_top":m=-W,x=A,p=a=S=0,L=-v;break;case"left_bottom":m=-W,x=-$,p=a=S=0,L=v;break;case"left_h":m=-W,p=a=S=x=0,L=v;break;case"left_v":m=-W,p=v,L=a=S=x=0;break;case"right_left":m=P,S=B,p=-v,L=a=x=0;break;case"right_right":m=P,S=-g,p=v,L=a=x=0;break;case"right_top":m=P,x=A,p=a=S=0,L=v;break;case"right_bottom":m=P,x=-$,p=a=S=0,L=-v;break;case"right_h":m=P,p=a=S=x=0,L=v;break;case"right_v":m=P,p=v,L=a=S=x=0;break;case"top_left":m=-W,x=A,p=a=S=0,L=v;break;case"top_right":m=P,x=A,p=a=S=0,L=-v;break;case"top_top":x=A,S=-g,a=-v,L=p=m=0;break;case"top_bottom":x=A,S=B,a=v,L=p=m=0;break;case"top_h":x=A,a=v,L=p=S=m=0;break;case"top_v":x=A,p=a=S=m=0,L=v;break;case"bottom_left":m=-W,x=-$,p=a=S=0,L=-v;break;case"bottom_right":m=P,x=-$,p=a=S=0,L=v;break;case"bottom_top":x=-$,S=B,a=-v,L=p=m=0;break;case"bottom_bottom":x=-$,S=-g,a=v,L=p=m=0;break;case"bottom_h":x=-$,a=v,L=p=S=m=0;break;case"bottom_v":x=-$,p=a=S=m=0,L=v}return T([{t3:[-m,-x,-S]},{r3:[a,p,L]},{t3:[m,x,S]}])}});function _t(b,v){this.position=b,this.$22n=v}_t.prototype.clone=function(){return new _t(this.position.clone(),this.$22n.clone())};m(X.graph3d.Graph3dView,{createDecal:function(b,v,m,x){var S=this,a=S.getDataAt(b);if(a){var p,L,e,b=S.intersectObject(b,a);if(b)return v="object"==typeof v?v.x?new s(v.x,v.y,v.z):new s(v[0],v[1],v[2]):new s(v=v||20,v,v),m=m===R?.1:m,e=new s(S.getUp()),p=(L=new s(S.getCenter()).sub(new s(S.getEye())).normalize()).clone().cross(e).normalize(),e.copy(p).cross(L).normalize(),x&&e.applyAxisAngle(b.worldNormal,-x),p=new X.Node,L=b.worldNormal.clone().setLength(m).add(b.world),x=(new F).lookAt(b.worldNormal.clone(),new s(0,0,0),e),m=(new M).setFromRotationMatrix(x),e=r(S,a,b.world.clone(),m,v),p.p3(L.x,L.y,L.z),p.setEuler(m),p.s3(v.x,v.y,v.z),p.s({shape3d:e,"shape3d.reverse.flip":!0}),p}}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),void Object);