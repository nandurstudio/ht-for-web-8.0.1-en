!function(K,pg,W){"use strict";var X,Y=K.ht,S=Y.Default,A=S.getInternal(),P=(S.clone,S.def),e=(Y.WebGLVarants,Y.Math.Matrix4),E=Y.Math.Vector4,o=Y.Math.Euler,t=Y.Math.Quaternion,O=Y.Math.Vector3;function r(P){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(P);for(var U="",f=0,b=P.length;f<b;f++)U+=String.fromCharCode(P[f]);try{return decodeURIComponent(escape(U))}catch(P){return U}}function w(P,U,f){return U===W&&(U=0),f===W&&(f=P.byteLength),r(new Uint8Array(P,U,f))}function J(P){return P/46186158e3}function I(P){return P*Math.PI/180}var m=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];function q(P){return 6<=(P=P||0)?m[0]:m[P]}function v(P,U,f){(U=U[f])!==W&&(P[f]=U)}function j(P,U){if(b="Kaydara FBX Binary  \0",(u=P).byteLength>=b.length&&b===w(u,0,b.length))X=(new D)._zS(P);else{u=w(P);if(!function(f){var P=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],b=0;for(var U=0;U<P.length;++U)if(function(P){var U=f[P-1];return f=f.slice(b+P),b++,U}(1)===P[U])return;return 1}(u))throw new Error("Unknown format.");if(V(u)<7e3)throw new Error("FBX version not supported, FileVersion: "+V(u));X=(new d)._zS(u)}var r,f,b=(new UO)._zS(U),K={model3d:!0},u=((P=b.externalAssetURIs)&&(K.externalAssetURIs=P),b.materialMap),N=(u&&(r=K.matDef={},u.forEach(function(P){var U,f=P.name,b=r[f]={};for(U in P)"name"!==U&&"setValues"!==U&&(b[U]=P[U])})),H(K,b,U,{}),{}),s={},p=!1,T=(S.traverse(K,null,function(P){if(N[P.name]){for(P.displayName=P.name;f=P.name+"_"+Y.Math.generateIncreasingID(),N[f];);P.name=f}N[P.name]=P.ID,s[P.ID]=P.name,delete P.ID,"__undefined__"===P.mat&&(p=!0)},"comps"),p&&(K.matDef||(K.matDef={}),K.matDef.__undefined__||(K.matDef.__undefined__={type:(new Z).type})),K.animations&&K.animations.forEach(function(P){P.tracks.forEach(function(P){var U=P.name.split(".");U[0]&&s[U[0]]&&(P.name=s[U[0]]+"."+U.slice(1).join("."))})}),S.traverse(K,null,function(P){var U=P.skeleton;if(U){for(var f=U[0],b=f.length,r=new Array(b),K=0;K<b;K++)r[K]=f[K].name;P.skeleton={bones:r,boneMatrixInverses:U[1],bindMatrix:U[2].toArray(),bindMatrixInverse:(new e).copy(U[2]).invert().toArray()}}},"comps"),S.traverse(K,null,function(P){var U=P.comps;if(U)for(var f=U.length-1;0<=f;f--){var b=U[f];b.mesh||b.isBone||b.comps&&b.comps.length||U.splice(f,1)}},"comps"),A.completeCubeCenterOfModel3d(K,{scene:b,cube:U.cube,center:U.center,rotationMode:U.rotationMode,t3:U.t3,r3:U.r3,s3:U.s3}),!1!==U.flipY&&S.traverse(K,function(P){P=P.mesh;if(P&&(P.uv||P.uv2)){for(var U=1,f=P.uv,b=f?f.length:0;U<b;U+=2)f[U]=1-f[U];for(U=1,b=(f=P.uv2)?f.length:0;U<b;U+=2)f[U]=1-f[U]}},null,"comps"),U.matDef);if(T)if(K.matDef)for(var E in T)K.matDef[E]=T[E];else K.matDef=T;return U.shape3d&&S.setShape3dModel(U.shape3d,K),U.playAutomatically&&(K.playAutomatically=!0),!U.ignoreNormal&&U.mikktTangent&&Y.Math.MikktSpaceAlgorithm&&Y.Math.MikktSpaceAlgorithm.generateMikktTangents(K,U.tangentFlipW),K}function a(){this.add=function(P,U){this[P]=U}}var f,b,u,M={position:"vs",normal:"ns"},k=new e,g=(f=new O,b=new t,u=new O,function(P,U){U.decompose(f,b,u),P.position=f.toArray(),P.quaternion=b.toArray(),P.scale=u.toArray()}),H=function(P,U,f,b){var r=U.mat;if(r)if(r instanceof Array){for(var K=[],u=0,N=r.length;u<N;u++)K.push(r[u].name);P.mat=K}else P.mat=r.name;var s=U.mesh;if(s){P.mesh=p={},s.index&&(p.is=s.index.array);var p,T,E=s.attributes;for(T in E){var X=M[T]||T;f.ignoreNormal&&"ns"===X||(p[X]=E[T].array)}var s=s.groups;s&&(P.subMeshes=s),P.mat||(P.mat="__undefined__")}!(P.mat&&P.mat instanceof Array&&P.mat.length)||P.subMeshes&&P.subMeshes.length||(delete P.subMeshes,P.mat=P.mat[0],console.warn("Unable to locate group boundaries in the sub-meshes. This may lead to incorrect rendering of this mesh.")),U.matrix.equals(k)||g(P,U.matrix),U.userData&&(s=U.userData.transformData)&&(s.rotationOffset||s.rotationPivot||s.scalingOffset||s.scalingPivot||2===s.inheritType)&&((A=P.transformData={}).inheritType=s.inheritType||2,A.translation=s.translation||[0,0,0],s.rotation?((S=s.rotation.map(I)).push(s.eulerOrder),A.rotation=S):A.rotation=[0,0,0,1],A.scale=s.scale||[1,1,1],v(A,s,"rotationOffset"),v(A,s,"rotationPivot"),v(A,s,"scalingOffset"),v(A,s,"scalingPivot"));U.isBone&&(P.isBone=!0),P.name=U.name,P.ID=U.ID;var Y,S=U.skeleton,A=(S&&(P.skeleton=S),U.animations),o=(A&&(P.animations=A),U.getChildren().getArray());if(o){P.comps=[];for(u=0,N=o.length;u<N;u++)P.comps.push(Y={}),H(Y,o[u],f,b)}},C=(A.addMethod(S,{loadFbx:function(b,r){(r=r||{}).responseType="arraybuffer",S.xhrLoad(b,function(P){var U,f;P=P,U=r.finishFunc,f=r.shape3d,(P=P?j(P,r):null)?U&&U(P,b,f):U&&U(null)},r)},parseFbx:j}),new o),Q=new O;function F(P){var U=new e,f=new e,b=new e,r=new e,K=new e,u=new e,N=new e,s=new e,p=new e,T=new e,E=new e,X=new e,Y=P.inheritType||0,S=(P.translation&&U.setPosition(Q.fromArray(P.translation)),P.preRotation&&((S=P.preRotation.map(I)).push(P.eulerOrder),f.makeRotationFromEuler(C.fromArray(S))),P.rotation&&((S=P.rotation.map(I)).push(P.eulerOrder),b.makeRotationFromEuler(C.fromArray(S))),P.postRotation&&((S=P.postRotation.map(I)).push(P.eulerOrder),r.makeRotationFromEuler(C.fromArray(S)),r.invert()),P.scale&&K.scale(Q.fromArray(P.scale)),P.scalingOffset&&N.setPosition(Q.fromArray(P.scalingOffset)),P.scalingPivot&&u.setPosition(Q.fromArray(P.scalingPivot)),P.rotationOffset&&s.setPosition(Q.fromArray(P.rotationOffset)),P.rotationPivot&&p.setPosition(Q.fromArray(P.rotationPivot)),P.parentMatrixWorld&&(E.copy(P.parentMatrix),T.copy(P.parentMatrixWorld)),f.clone().multiply(b).multiply(r)),P=new e,A=(P.extractRotation(T),new e),A=(A.copyPosition(T),A.clone().invert().multiply(T)),A=P.clone().invert().multiply(A),o=K,t=new e,A=(0===Y?t.copy(P).multiply(S).multiply(A).multiply(o):1===Y?t.copy(P).multiply(A).multiply(S).multiply(o):(Y=(new e).scale((new O).setFromMatrixScale(E)).clone().invert(),E=A.clone().multiply(Y),t.copy(P).multiply(S).multiply(E).multiply(o)),p.clone().invert()),Y=u.clone().invert(),P=U.clone().multiply(s).multiply(p).multiply(f).multiply(b).multiply(r).multiply(A).multiply(N).multiply(u).multiply(K).multiply(Y),S=(new e).copyPosition(P),E=T.clone().multiply(S);return X.copyPosition(E),(P=X.clone().multiply(t)).premultiply(T.invert()),P}var B=[];function L(P,U,f,b){var r;switch(b.mappingType){case"ByPolygonVertex":r=P;break;case"ByPolygon":r=U;break;case"ByVertice":r=f;break;case"AllSame":r=b.indices[0];break;default:console.warn("unknown attribute mapping type "+b.mappingType)}for(var K=(r="IndexToDirect"===b.referenceType?b.indices[r]:r)*b.dataSize,u=K+b.dataSize,N=B,s=b.buffer,p=u,T=K,E=0;T<p;T++,E++)N[E]=s[T];return N}function c(P,U,f){return P.slice(0,U).concat(f).concat(P.slice(U))}var y=new RegExp("[\\[\\]\\.:\\/]","g");function T(P){return P.replace(/\s/g,"_").replace(y,"")}function V(P){P=P.match(/FBXVersion: (\d+)/);if(P)return parseInt(P[1]);throw new Error("Cannot find the version number for the file given.")}function $(P){return P.split(",").map(function(P){return parseFloat(P)})}function h(){this.userData={},this.matrix=new e,this.matrixWorld=new e,h.superClass.constructor.apply(this,arguments)}function R(P){for(var U in this.texture=!0,P)this[U]=P[U]}function N(P,U){this.mat=U,this.mesh=P,this.userData={},N.superClass.constructor.apply(this,arguments)}function G(P,U){this.dv=new DataView(P),this.offset=0,this.littleEndian=U===W||U,this.getOffset=function(){return this.offset},this.size=function(){return this.dv.buffer.byteLength},this.skip=function(P){this.offset+=P},this._hS=function(){return 1==(1&this.getUint8())},this._iS=function(P){for(var U=[],f=0;f<P;f++)U.push(this._hS());return U},this.getUint8=function(){var P=this.dv.getUint8(this.offset);return this.offset+=1,P},this.getInt16=function(){var P=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,P},this.getInt32=function(){var P=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,P},this.getInt32Array=function(P){for(var U=[],f=0;f<P;f++)U.push(this.getInt32());return U},this.getUint32=function(){var P=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,P},this.getInt64=function(){var P,U;return this.littleEndian?(P=this.getUint32(),U=this.getUint32()):(U=this.getUint32(),P=this.getUint32()),2147483648&U?(U=4294967295&~U,-(4294967296*(U=4294967295===(P=4294967295&~P)?U+1&4294967295:U)+(P=P+1&4294967295))):4294967296*U+P},this.getInt64Array=function(P){for(var U=[],f=0;f<P;f++)U.push(this.getInt64());return U},this.getUint64=function(){var P,U;return this.littleEndian?(P=this.getUint32(),U=this.getUint32()):(U=this.getUint32(),P=this.getUint32()),4294967296*U+P},this.getFloat32=function(){var P=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,P},this.getFloat32Array=function(P){for(var U=[],f=0;f<P;f++)U.push(this.getFloat32());return U},this.getFloat64=function(){var P=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,P},this.getFloat64Array=function(P){for(var U=[],f=0;f<P;f++)U.push(this.getFloat64());return U},this._vS=function(P){var U=this.dv.buffer.slice(this.offset,this.offset+P);return this.offset+=P,U},this.getString=function(P){for(var U=[],f=0;f<P;f++)U[f]=this.getUint8();var b=U.indexOf(0);return 0<=b&&(U=U.slice(0,b)),r(new Uint8Array(U))}}function n(){this.uuid=Y.Math.generateUUID(),this.name="",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null}P(h,Y.Data,{add:function(P){this.addChild(P)},traverse:function(P){S.traverse(this,P)},applyMatrix4:function(P){this.matrix.premultiply(P),this.getParent()?this.matrixWorld.multiplyMatrices(this.getParent().matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix)}});var l,p,s,Z=function(){this.type="pbr",this.setValues=function(P){if(P){for(var U in P)this[U]=P[U];return this}},this.clone=function(){var P,U=new Z;for(P in this)this[P]&&(U[P]=this[P]);return U}},d=(P(N,h,{normalizeSkinWeights:function(){var P=new Y.Math.Vector4,U=this.mesh.attributes.skinWeight;if(U)for(var f=0,b=U.count;f<b;f++){P.fromBufferAttribute(U,f);var r=1/P.manhattanLength();r!=1/0?P.multiplyScalar(r):P.set(1,0,0,0),U.setXYZW(f,P.x,P.y,P.z,P.w)}}}),function(){this._2S=function(){return this.nodeStack[this.currentIndent-2]},this._3S=function(){return this.nodeStack[this.currentIndent-1]},this._4S=function(){return this.currentProp},this._5S=function(P){this.nodeStack.push(P),this.currentIndent+=1},this._6S=function(){this.nodeStack.pop(),--this.currentIndent},this._7S=function(P,U){this.currentProp=P,this.currentPropName=U},this._zS=function(P){this.currentIndent=0,this.allNodes=new a,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var K=this,u=P.split(/[\r\n]+/);return u.forEach(function(P,U){var f,b=P.match(/^[\s\t]*;/),r=P.match(/^[\s\t]*$/);b||r||(b=P.match("^\\t{"+K.currentIndent+"}(\\w+):(.*){",""),r=P.match("^\\t{"+K.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),f=P.match("^\\t{"+(K.currentIndent-1)+"}}"),b?K._8S(P,b):r?K._aS(P,r,u[++U]):f?K._6S():P.match(/^[^\s\t}]/)&&K._bS(P))}),this.allNodes},this._8S=function(P,U){var f=U[1].trim().replace(/^"/,"").replace(/"$/,""),U=U[2].split(",").map(function(P){return P.trim().replace(/^"/,"").replace(/"$/,"")}),b={name:f},U=this._9S(U),r=this._3S();0===this.currentIndent?this.allNodes.add(f,b):f in r?("PoseNode"===f?r.PoseNode.push(b):r[f].id!==W&&(r[f]={},r[f][r[f].id]=r[f]),""!==U.id&&(r[f][U.id]=b)):"number"==typeof U.id?(r[f]={},r[f][U.id]=b):"Properties70"!==f&&(r[f]="PoseNode"===f?[b]:b),"number"==typeof U.id&&(b.id=U.id),""!==U.name&&(b.attrName=U.name),""!==U.type&&(b.attrType=U.type),this._5S(b)},this._9S=function(P){var U=P[0],f=(""!==P[0]&&(U=parseInt(P[0]),isNaN(U)&&(U=P[0])),""),b="";return 1<P.length&&(f=P[1].replace(/^(\w+)::/,""),b=P[2]),{id:U,name:f,type:b}},this._aS=function(P,U,f){var b=U[1].replace(/^"/,"").replace(/"$/,"").trim(),U=U[2].replace(/^"/,"").replace(/"$/,"").trim(),f=("Content"===b&&","===U&&(U=f.replace(/"/g,"").replace(/,$/,"").trim()),this._3S());if("Properties70"===f.name)this._cS(P,b,U);else{if("C"===b){for(var P=U.split(",").slice(1),r=parseInt(P[0]),P=parseInt(P[1]),K=(K=U.split(",").slice(3)).map(function(P){return P.trim().replace(/^"/,"")}),b="connections",u=U=[r,P],N=K,s=0,p=u.length,T=N.length;s<T;s++,p++)u[p]=N[s];f[b]===W&&(f[b]=[])}"Node"===b&&(f.id=U),b in f&&Array.isArray(f[b])?f[b].push(U):"a"!==b?f[b]=U:f.a=U,this._7S(f,b),"a"===b&&","!==U.slice(-1)&&(f.a=$(U))}},this._bS=function(P){var U=this._3S();U.a+=P,","!==P.slice(-1)&&(U.a=$(U.a))},this._cS=function(P,U,f){var f=f.split('",').map(function(P){return P.trim().replace(/^\"/,"").replace(/\s/,"_")}),b=f[0],r=f[1],K=f[2],u=f[3],N=f[4];switch(r){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":N=parseFloat(N);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":N=$(N)}this._2S()[b]={type:r,type2:K,flag:u,value:N},this._7S(this._2S(),b)}}),D=function(){this._zS=function(P){var U=new G(P),f=(U.skip(23),U.getUint32());if(f<6400)throw new Error("FBX version not supported : "+f);for(var b=new a;!this._dS(U);){var r=this._eS(U,f);null!==r&&b.add(r.name,r)}return b},this._dS=function(P){return P.size()%16==0?(P.getOffset()+160+16&-16)>=P.size():P.getOffset()+160+16>=P.size()},this._eS=function(P,U){var f={},b=7500<=U?P.getUint64():P.getUint32(),r=7500<=U?P.getUint64():P.getUint32(),K=(7500<=U?P.getUint64():P.getUint32(),P.getUint8()),u=P.getString(K);if(0===b)return null;for(var N=[],s=0;s<r;s++)N.push(this._gS(P));var K=0<N.length?N[0]:"",p=1<N.length?N[1]:"",T=2<N.length?N[2]:"";for(f.singleProperty=1===r&&P.getOffset()===b;b>P.getOffset();){var E=this._eS(P,U);null!==E&&this._fS(u,f,E)}return f.propertyList=N,"number"==typeof K&&(f.id=K),""!==p&&(f.attrName=p),""!==T&&(f.attrType=T),""!==u&&(f.name=u),f},this._fS=function(P,U,f){var b,r,K,u,N;!0===f.singleProperty?(r=f.propertyList[0],Array.isArray(r)?(U[f.name]=f).a=r:U[f.name]=r):"Connections"===P&&"C"===f.name?(b=[],f.propertyList.forEach(function(P,U){0!==U&&b.push(P)}),U.connections===W&&(U.connections=[]),U.connections.push(b)):"Properties70"===f.name?pg.keys(f).forEach(function(P){U[P]=f[P]}):"Properties70"===P&&"P"===f.name?(r=f.propertyList[0],P=f.propertyList[1],K=f.propertyList[2],u=f.propertyList[3],0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),N="Color"===(P=0===P.indexOf("Lcl ")?P.replace("Lcl ","Lcl_"):P)||"ColorRGB"===P||"Vector"===P||"Vector3D"===P||0===P.indexOf("Lcl_")?[f.propertyList[4],f.propertyList[5],f.propertyList[6]]:f.propertyList[4],U[r]={type:P,type2:K,flag:u,value:N}):U[f.name]===W?"number"==typeof f.id?(U[f.name]={},U[f.name][f.id]=f):U[f.name]=f:"PoseNode"===f.name?(Array.isArray(U[f.name])||(U[f.name]=[U[f.name]]),U[f.name].push(f)):U[f.name][f.id]===W&&(U[f.name][f.id]=f)},this._gS=function(P){var U=P.getString(1);switch(U){case"C":return P._hS();case"D":return P.getFloat64();case"F":return P.getFloat32();case"I":return P.getInt32();case"L":return P.getInt64();case"R":return b=P.getUint32(),P._vS(b);case"S":return b=P.getUint32(),P.getString(b);case"Y":return P.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var f=P.getUint32(),b=P.getUint32(),r=P.getUint32();if(0===b)switch(U){case"b":case"c":return P._iS(f);case"d":return P.getFloat64Array(f);case"f":return P.getFloat32Array(f);case"i":return P.getInt32Array(f);case"l":return P.getInt64Array(f)}void 0===PO&&console.error("Require External library fflate.min.js.");var b=PO.unzlibSync(new Uint8Array(P._vS(r))),K=new G(b.buffer);switch(U){case"b":case"c":return K._iS(f);case"d":return K.getFloat64Array(f);case"f":return K.getFloat32Array(f);case"i":return K.getInt32Array(f);case"l":return K.getInt64Array(f)}default:throw new Error("Unknown property type "+U)}}},PO=function(){function Y(P,U){for(var f=new B(31),b=0;b<31;++b)f[b]=U+=1<<P[b-1];var r=new c(f[30]);for(b=1;b<30;++b)for(var K=f[b];K<f[b+1];++K)r[K]=K-f[b]<<5|b;return[f,r]}var P={},S=("undefined"!=typeof module&&"object"==typeof exports?function(P){var N;try{N=require("worker_threads").Worker}catch(N){}return exports.default=N?function(P,U,f,b,r){var K=!1,u=new N(P+";var __w=require('worker_threads');__w.parentPort.on('message',function(m){onmessage({data:m})}),postMessage=function(m,t){__w.parentPort.postMessage(m,t)},close=process.exit;self=global",{eval:!0}).on("error",function(P){return r(P,null)}).on("message",function(P){return r(null,P)}).on("exit",function(P){P&&!K&&r(Error("exited with code "+P),null)});return u._wS(f,b),u.terminate=function(){return K=!0,N.prototype.terminate.call(u)},u}:function(P,U,f,b,r){setImmediate(function(){return r(Error("async operations unsupported - update to Node 12+ (or Node 10-11 with the --experimental-worker CLI flag)"),null)});function K(){}return{terminate:K,_wS:K}},P}:function(P){var K={},u=function(P){return URL.createObjectURL(new Blob([P],{type:"text/javascript"}))},N=function(P){return new Worker(P)};try{URL.revokeObjectURL(u(""))}catch(K){u=function(P){return"data:application/javascript;charset=UTF-8,"+encodeURI(P)},N=function(P){return new Worker(P,{type:"module"})}}return P.default=function(P,U,f,b,r){U=N(K[U]||(K[U]=u(P)));return U._yS=function(P){return r(P.error,null)},U._xS=function(P){return r(null,P.data)},U._wS(f,b),U},P})({}),F=Uint8Array,B=Uint16Array,c=Uint32Array,y=new F([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),V=new F([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),q=new F([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),U=Y(y,2),g=U[0],d=U[1];g[28]=258,d[258]=28;for(var U=Y(V,0),H=U[0],D=U[1],t=new B(32768),f=0;f<32768;++f){var b=(43690&f)>>>1|(21845&f)<<1;t[f]=((65280&(b=(61680&(b=(52428&b)>>>2|(13107&b)<<2))>>>4|(3855&b)<<4))>>>8|(255&b)<<8)>>>1}for(var j=function(P,U,f){for(var b=P.length,r=0,K=new B(U);r<b;++r)++K[P[r]-1];var u=new B(U);for(r=0;r<U;++r)u[r]=u[r-1]+K[r-1]<<1;if(f){for(var N=new B(1<<U),s=15-U,r=0;r<b;++r)if(P[r])for(var p=r<<4|P[r],T=U-P[r],E=u[P[r]-1]++<<T,X=E|(1<<T)-1;E<=X;++E)N[t[E]>>>s]=p}else for(N=new B(b),r=0;r<b;++r)P[r]&&(N[r]=t[u[P[r]-1]++]>>>15-P[r]);return N},w=new F(288),f=0;f<144;++f)w[f]=8;for(f=144;f<256;++f)w[f]=9;for(f=256;f<280;++f)w[f]=7;for(f=280;f<288;++f)w[f]=8;var J=new F(32);for(f=0;f<32;++f)J[f]=5;function PO(P){for(var U=P[0],f=1;f<P.length;++f)P[f]>U&&(U=P[f]);return U}function a(P,U,f){var b=U/8|0;return(P[b]|P[1+b]<<8)>>(7&U)&f}function UO(P,U){var f=U/8|0;return(P[f]|P[1+f]<<8|P[2+f]<<16)>>(7&U)}function e(U,P,f,b,r,K){var u=U.length,N=new F(b+u+5*(1+Math.ceil(u/7e3))+r),s=N.subarray(b,N.length-r),p=0;if(!P||u<8)for(var T=0;T<=u;T+=65535){var E=T+65535;p=E<u?pO(s,p,U.subarray(T,E)):(s[T]=K,pO(s,p,U.subarray(T,u)))}else{for(var P=EO[P-1],J=P>>>13,m=8191&P,X=(1<<f)-1,Y=new B(32768),S=new B(1+X),A=Math.ceil(f/3),q=2*A,o=function(P){return(U[P]^U[P+1]<<A^U[P+2]<<q)&X},t=new c(25e3),e=new B(288),O=new B(32),I=0,W=0,v=T=0,C=0,Q=0;T<u;++T){var L=o(T),$=32767&T,h=S[L];if(Y[$]=h,S[L]=$,C<=T){var n=u-T;if((7e3<I||24576<v)&&423<n){p=TO(U,s,0,t,e,O,W,v,Q,T-Q,p),v=I=W=0,Q=T;for(var l=0;l<286;++l)e[l]=0;for(l=0;l<30;++l)O[l]=0}var Z=2,z=0,j=m,_=$-h&32767;if(2<n&&L==o(T-_))for(var a=Math.min(J,n)-1,M=Math.min(32767,T),k=Math.min(258,n);_<=M&&--j&&$!=h;){if(U[T+Z]==U[T+Z-_]){for(var x=0;x<k&&U[T+x]==U[T+x-_];++x);if(Z<x){if(z=_,a<(Z=x))break;var g=Math.min(_,x-2),i=0;for(l=0;l<g;++l){var w=T-_+l+32768&32767,H=w-Y[w]+32768&32767;i<H&&(i=H,h=w)}}}_+=($=h)-(h=Y[$])+32768&32767}z?(t[v++]=268435456|d[Z]<<18|D[z],L=31&d[Z],n=31&D[z],W+=y[L]+V[n],++e[257+L],++O[n],C=T+Z,++I):(t[v++]=U[T],++e[U[T]])}}p=TO(U,s,K,t,e,O,W,v,Q,T-Q,p),!K&&7&p&&(p=pO(s,p+1,G))}return R(N,0,b+uO(p)+r)}function r(){return[F,B,c,y,V,q,g,H,bO,KO,t,j,PO,a,UO,uO,R,Z,A,u,l]}function K(){return[F,B,c,y,V,q,d,D,fO,w,rO,J,t,EO,G,j,m,M,NO,z,sO,k,pO,TO,uO,R,e,T,$O,u]}function O(){return[tO,IO,o,L,_]}function v(){return[eO,OO]}function C(){return[WO,o,x]}function Q(){return[vO]}function u(P){return postMessage(P,[P.buffer])}function l(P){return P&&P.size&&new F(P.size)}function N(P,U,f,b,r,K){var u=AO(f,b,r,function(P,U){u.terminate(),K(P,U)});return u._wS([P,U],U.consume?[P.buffer]:[]),function(){u.terminate()}}function s(U){return U.ondata=function(P,U){return postMessage([P,U],[P.buffer])},function(P){return U.push(P.data[0],P.data[1])}}function p(P,f,U,b,r){var K,u=AO(P,b,r,function(P,U){P?(u.terminate(),f.ondata.call(f,P)):(U[1]&&u.terminate(),f.ondata.call(f,P,U[0],U[1]))});u._wS(U),f.push=function(P,U){if(K)throw"stream finished";if(!f.ondata)throw"no stream handler";u._wS([P,K=U],[P.buffer])},f.terminate=function(){u.terminate()}}var fO=j(w,9,0),bO=j(w,9,1),rO=j(J,5,0),KO=j(J,5,1),uO=function(P){return(P/8|0)+(7&P&&1)},R=function(P,U,f){(null==U||U<0)&&(U=0),(null==f||f>P.length)&&(f=P.length);var b=new(P instanceof B?B:P instanceof c?c:F)(f-U);return b.set(P.subarray(U,f)),b},Z=function(P,f,U){var b=P.length;if(!b||U&&!U.l&&b<5)return f||new F(0);function r(P){var U=f.length;U<P&&((U=new F(Math.max(2*U,P))).set(f),f=U)}var K=!f||U,u=!U||U.i,N=(U=U||{},f=f||new F(3*b),U.f||0),s=U.p||0,p=U.b||0,T=U.l,E=U.d,X=U.m,Y=U.n,S=8*b;do{if(!T){U.f=N=a(P,s,1);var A=a(P,s+1,3);if(s+=3,!A){var o=P[(L=uO(s)+4)-4]|P[L-3]<<8,t=L+o;if(b<t){if(u)throw"unexpected EOF";break}K&&r(p+o),f.set(P.subarray(L,t),p),U.b=p+=o,U.p=s=8*t;continue}if(1==A)T=bO,E=KO,X=9,Y=5;else{if(2!=A)throw"invalid block type";var o=a(P,s,31)+257,e=a(P,s+10,15)+4,O=o+a(P,s+5,31)+1;s+=14;for(var I=new F(O),W=new F(19),v=0;v<e;++v)W[q[v]]=a(P,s+3*v,7);s+=3*e;for(var t=PO(W),C=(1<<t)-1,Q=j(W,t,1),v=0;v<O;){var L,$=Q[a(P,s,C)];if(s+=15&$,(L=$>>>4)<16)I[v++]=L;else{var h=0,n=0;for(16==L?(n=3+a(P,s,3),s+=2,h=I[v-1]):17==L?(n=3+a(P,s,7),s+=3):18==L&&(n=11+a(P,s,127),s+=7);n--;)I[v++]=h}}var A=I.subarray(0,o),l=I.subarray(o),X=PO(A),Y=PO(l),T=j(A,X,1),E=j(l,Y,1)}if(S<s){if(u)throw"unexpected EOF";break}}K&&r(p+131072);for(var J=(1<<X)-1,m=(1<<Y)-1,Z=s;;Z=s){var z=(h=T[UO(P,s)&J])>>>4;if((s+=15&h)>S){if(u)throw"unexpected EOF";break}if(!h)throw"invalid length/literal";if(z<256)f[p++]=z;else{if(256==z){Z=s,T=null;break}var _,x=z-254,z=(264<z&&(x=a(P,s,(1<<(_=y[v=z-257]))-1)+g[v],s+=_),E[UO(P,s)&m]),i=z>>>4;if(!z)throw"invalid distance";if(s+=15&z,l=H[i],3<i&&(_=V[i],l+=UO(P,s)&(1<<_)-1,s+=_),S<s){if(u)throw"unexpected EOF";break}K&&r(p+131072);for(var w=p+x;p<w;p+=4)f[p]=f[p-l],f[p+1]=f[p+1-l],f[p+2]=f[p+2-l],f[p+3]=f[p+3-l];p=w}}U.l=T,U.p=Z,U.b=p,T&&(N=1,U.m=X,U.d=E,U.n=Y)}while(!N);return p==f.length?f:R(f,0,p)},m=function(P,U,f){var b=U/8|0;P[b]|=f<<=7&U,P[1+b]|=f>>>8},M=function(P,U,f){var b=U/8|0;P[b]|=f<<=7&U,P[1+b]|=f>>>8,P[2+b]|=f>>>16},NO=function(P,U){for(var f=[],b=0;b<P.length;++b)P[b]&&f.push({s:b,f:P[b]});var r=f.length,K=f.slice();if(!r)return[G,0];if(1==r)return(A=new F(f[0].s+1))[f[0].s]=1,[A,1];f.sort(function(P,U){return P.f-U.f}),f.push({s:-1,f:25001});var u=f[0],N=f[1],s=0,p=1,T=2;for(f[0]={s:-1,f:u.f+N.f,l:u,r:N};p!=r-1;)u=f[f[s].f<f[T].f?s++:T++],N=f[s!=p&&f[s].f<f[T].f?s++:T++],f[p++]={s:-1,f:u.f+N.f,l:u,r:N};var E=K[0].s;for(b=1;b<r;++b)K[b].s>E&&(E=K[b].s);var X=new B(E+1),Y=z(f[p-1],X,0);if(U<Y){var b=0,S=0,A=Y-U,o=1<<A;for(K.sort(function(P,U){return X[U.s]-X[P.s]||P.f-U.f});b<r;++b){var t=K[b].s;if(!(X[t]>U))break;S+=o-(1<<Y-X[t]),X[t]=U}for(S>>>=A;0<S;){var e=K[b].s;X[e]<U?S-=1<<U-X[e]++-1:++b}for(;0<=b&&S;--b){var O=K[b].s;X[O]==U&&(--X[O],++S)}Y=U}return[new F(X),Y]},z=function(P,U,f){return-1==P.s?Math.max(z(P.l,U,f+1),z(P.r,U,f+1)):U[P.s]=f},sO=function(P){for(var U=P.length;U&&!P[--U];);for(var f=new B(++U),b=0,r=P[0],K=1,u=function(P){f[b++]=P},N=1;N<=U;++N)if(P[N]==r&&N!=U)++K;else{if(!r&&2<K){for(;138<K;K-=138)u(32754);2<K&&(u(10<K?K-11<<5|28690:K-3<<5|12305),K=0)}else if(3<K){for(u(r),--K;6<K;K-=6)u(8304);2<K&&(u(K-3<<5|8208),K=0)}for(;K--;)u(r);K=1,r=P[N]}return[f.subarray(0,b),U]},k=function(P,U){for(var f=0,b=0;b<U.length;++b)f+=P[b]*U[b];return f},pO=function(P,U,f){var b=f.length,r=uO(U+2);P[r]=255&b,P[r+1]=b>>>8,P[r+2]=255^P[r],P[r+3]=255^P[r+1];for(var K=0;K<b;++K)P[r+K+4]=f[K];return 8*(r+4+b)},TO=function(P,U,f,b,r,K,u,N,s,p,T){m(U,T++,f),++r[256];for(var f=NO(r,15),E=f[0],f=f[1],X=NO(K,15),Y=X[0],X=X[1],S=sO(E),A=S[0],S=S[1],o=sO(Y),t=o[0],o=o[1],e=new B(19),O=0;O<A.length;++O)e[31&A[O]]++;for(O=0;O<t.length;++O)e[31&t[O]]++;for(var I=NO(e,7),W=I[0],I=I[1],v=19;4<v&&!W[q[v-1]];--v);var C,Q,L=p+5<<3,$=k(r,w)+k(K,J)+u,r=k(r,E)+k(K,Y)+u+14+3*v+k(e,W)+(2*e[16]+3*e[17]+7*e[18]);if(L<=$&&L<=r)return pO(U,T,P.subarray(s,s+p));if(m(U,T,1+(r<$)),T+=2,r<$){var h=j(E,f,0),n=E,l=j(Y,X,0),Z=Y,z=j(W,I,0);for(m(U,T,S-257),m(U,T+5,o-1),m(U,T+10,v-4),T+=14,O=0;O<v;++O)m(U,T+3*O,W[q[O]]);T+=3*v;for(var _=[A,t],x=0;x<2;++x)for(var i=_[x],O=0;O<i.length;++O)m(U,T,z[C=31&i[O]]),T+=W[C],15<C&&(m(U,T,i[O]>>>5&127),T+=i[O]>>>12)}else h=fO,n=w,l=rO,Z=J;for(O=0;O<N;++O)255<b[O]?(M(U,T,h[257+(C=b[O]>>>18&31)]),T+=n[C+257],7<C&&(m(U,T,b[O]>>>23&31),T+=y[C]),Q=31&b[O],M(U,T,l[Q]),T+=Z[Q],3<Q&&(M(U,T,b[O]>>>5&8191),T+=V[Q])):(M(U,T,h[b[O]]),T+=n[b[O]]);return M(U,T,h[256]),T+n[256]},EO=new c([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),G=new F(0),_=function(){for(var P=new c(256),U=0;U<256;++U){for(var f=U,b=9;--b;)f=(1&f&&3988292384)^f>>>1;P[U]=f}return P}(),L=function(){var b=-1;return{p:function(P){for(var U=b,f=0;f<P.length;++f)U=_[255&U^P[f]]^U>>>8;b=U},d:function(){return~b}}},x=function(){var u=1,N=0;return{p:function(P){for(var U=u,f=N,b=P.length,r=0;r!=b;){for(var K=Math.min(r+2655,b);r<K;++r)f+=U+=P[r];U=(65535&U)+15*(U>>16),f=(65535&f)+15*(f>>16)}u=U,N=f},d:function(){return(255&(u%=65521))<<24|u>>>8<<16|(255&(N%=65521))<<8|N>>>8}}},T=function(P,U,f,b,r){return e(P,null==U.level?6:U.level,null==U.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(P.length)))):12+U.mem,f,b,!r)},i=function(P,U){var f,b={};for(f in P)b[f]=P[f];for(f in U)b[f]=U[f];return b},XO=function(P,U,f){for(var b=P(),P=""+P,r=P.slice(P.indexOf("[")+1,P.lastIndexOf("]")).replace(/ /g,"").split(","),K=0;K<b.length;++K){var u=b[K],N=r[K];if("function"==typeof u){U+=";"+N+"=";var s=""+u;if(u.prototype)if(-1!=s.indexOf("[native code]")){var p=s.indexOf(" ",8)+1;U+=s.slice(p,s.indexOf("(",p))}else for(var T in U+=s,u.prototype)U+=";"+N+".prototype."+T+"="+u.prototype[T];else U+=s}else f[N]=u}return[U,f]},YO=[],SO=function(P){var U,f=[];for(U in P)(P[U]instanceof F||P[U]instanceof B||P[U]instanceof c)&&f.push((P[U]=new P[U].varructor(P[U])).buffer);return f},AO=function(P,U,f,b){var r;if(!YO[f]){for(var K="",u={},N=P.length-1,s=0;s<N;++s)K=(r=XO(P[s],K,u))[0],u=r[1];YO[f]=XO(P[N],K,u)}var p=i({},YO[f][1]);return S.default(YO[f][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+U+"}",f,p,SO(p),b)},I=function(P,U){return P[U]|P[U+1]<<8},W=function(P,U){return(P[U]|P[U+1]<<8|P[U+2]<<16|P[U+3]<<24)>>>0},oO=function(P,U){return W(P,U)+4294967296*W(P,U+4)},o=function(P,U,f){for(;f;++U)P[U]=f,f>>>=8},tO=function(P,U){var f=U.filename;if(P[0]=31,P[1]=139,P[2]=8,P[8]=U.level<2?4:9==U.level?2:0,P[9]=3,0!=U.mtime&&o(P,4,Math.floor(new Date(U.mtime||Date.now())/1e3)),f){P[3]=8;for(var b=0;b<=f.length;++b)P[b+10]=f.charCodeAt(b)}},eO=function(P){if(31!=P[0]||139!=P[1]||8!=P[2])throw"invalid gzip data";var U=P[3],f=10;4&U&&(f+=P[10]|2+(P[11]<<8));for(var b=(U>>3&1)+(U>>4&1);0<b;b-=!P[f++]);return f+(2&U)},OO=function(P){var U=P.length;return(P[U-4]|P[U-3]<<8|P[U-2]<<16|P[U-1]<<24)>>>0},IO=function(P){return 10+(P.filename&&P.filename.length+1||0)},WO=function(P,U){U=U.level,U=0==U?0:U<6?1:9==U?3:2;P[0]=120,P[1]=U<<6|(U?32-2*U:1)},vO=function(P){if(8!=(15&P[0])||7<P[0]>>>4||(P[0]<<8|P[1])%31)throw"invalid zlib data";if(32&P[1])throw"invalid zlib data: preset dictionaries not supported"};function CO(P,U){return U||"function"!=typeof P||(U=P,P={}),this.ondata=U,P}var E=function(){function P(P,U){U||"function"!=typeof P||(U=P,P={}),this.ondata=U,this.o=P||{}}return P.prototype.p=function(P,U){this.ondata(T(P,this.o,0,0,!U),U)},P.prototype.push=function(P,U){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=U,this.p(P,U||!1)},P}(),QO=(P.Deflate=E,function(P,U){p([K,function(){return[s,E]}],this,CO.call(this,P,U),function(P){P=new E(P.data);onmessage=s(P)},6)});function LO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[K],function(P){return u($O(P.data[0],P.data[1]))},0,f)}function $O(P,U){return T(P,U||{},0,0)}P.AsyncDeflate=QO,P.deflate=LO,P.deflateSync=$O;var X=function(){function P(P){this.s={},this.p=new F(0),this.ondata=P}return P.prototype.e=function(P){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var U=this.p.length,f=new F(U+P.length);f.set(this.p),f.set(P,U),this.p=f},P.prototype.c=function(P){this.d=this.s.i=P||!1;var P=this.s.b,U=Z(this.p,this.o,this.s);this.ondata(R(U,P,this.s.b),this.d),this.o=R(U,this.s.b-32768),this.s.b=this.o.length,this.p=R(this.p,this.s.p/8|0),this.s.p&=7},P.prototype.push=function(P,U){this.e(P),this.c(U)},P}(),hO=(P.Inflate=X,function(P){this.ondata=P,p([r,function(){return[s,X]}],this,0,function(){var P=new X;onmessage=s(P)},7)});function nO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[r],function(P){return u(A(P.data[0],l(P.data[1])))},1,f)}function A(P,U){return Z(P,U)}P.AsyncInflate=hO,P.inflate=nO,P.inflateSync=A;var lO=function(){function P(P,U){this.c=L(),this.l=0,this.v=1,E.call(this,P,U)}return P.prototype.push=function(P,U){E.prototype.push.call(this,P,U)},P.prototype.p=function(P,U){this.c.p(P),this.l+=P.length;P=T(P,this.o,this.v&&IO(this.o),U&&8,!U);this.v&&(tO(P,this.o),this.v=0),U&&(o(P,P.length-8,this.c.d()),o(P,P.length-4,this.l)),this.ondata(P,U)},P}(),U=(P.Gzip=lO,P.Compress=lO,function(P,U){p([K,O,function(){return[s,E,lO]}],this,CO.call(this,P,U),function(P){P=new lO(P.data);onmessage=s(P)},8)});function ZO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[K,O,function(){return[zO]}],function(P){return u(zO(P.data[0],P.data[1]))},2,f)}function zO(P,U){U=U||{};var f=L(),b=P.length,P=(f.p(P),T(P,U,IO(U),8)),r=P.length;return tO(P,U),o(P,r-8,f.d()),o(P,r-4,b),P}P.AsyncGzip=U,P.AsyncCompress=U,P.gzip=ZO,P.compress=ZO,P.gzipSync=zO,P.compressSync=zO;var _O=function(){function P(P){this.v=1,X.call(this,P)}return P.prototype.push=function(P,U){if(X.prototype.e.call(this,P),this.v){P=3<this.p.length?eO(this.p):4;if(P>=this.p.length&&!U)return;this.p=this.p.subarray(P),this.v=0}if(U){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}X.prototype.c.call(this,U)},P}(),xO=(P.Gunzip=_O,function(P){this.ondata=P,p([r,v,function(){return[s,X,_O]}],this,0,function(){var P=new _O;onmessage=s(P)},9)});function iO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[r,v,function(){return[wO]}],function(P){return u(wO(P.data[0]))},3,f)}function wO(P,U){return Z(P.subarray(eO(P),-8),U||new F(OO(P)))}P.AsyncGunzip=xO,P.gunzip=iO,P.gunzipSync=wO;var JO=function(){function P(P,U){this.c=x(),this.v=1,E.call(this,P,U)}return P.prototype.push=function(P,U){E.prototype.push.call(this,P,U)},P.prototype.p=function(P,U){this.c.p(P);P=T(P,this.o,this.v&&2,U&&4,!U);this.v&&(WO(P,this.o),this.v=0),U&&o(P,P.length-4,this.c.d()),this.ondata(P,U)},P}(),U=(P.Zlib=JO,function(P,U){p([K,C,function(){return[s,E,JO]}],this,CO.call(this,P,U),function(P){P=new JO(P.data);onmessage=s(P)},10)});function mO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[K,C,function(){return[qO]}],function(P){return u(qO(P.data[0],P.data[1]))},4,f)}function qO(P,U){U=U||{};var f=x(),P=(f.p(P),T(P,U,2,4));return WO(P,U),o(P,P.length-4,f.d()),P}P.AsyncZlib=U,P.zlib=mO,P.zlibSync=qO;var jO=function(){function P(P){this.v=1,X.call(this,P)}return P.prototype.push=function(P,U){if(X.prototype.e.call(this,P),this.v){if(this.p.length<2&&!U)return;this.p=this.p.subarray(2),this.v=0}if(U){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}X.prototype.c.call(this,U)},P}(),aO=(P.Unzlib=jO,function(P){this.ondata=P,p([r,Q,function(){return[s,X,jO]}],this,0,function(){var P=new jO;onmessage=s(P)},11)});function MO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return N(P,U,[r,Q,function(){return[kO]}],function(P){return u(kO(P.data[0],l(P.data[1])))},5,f)}function kO(P,U){return Z((vO(P),P.subarray(2,-4)),U)}P.AsyncUnzlib=aO,P.unzlib=MO,P.unzlibSync=kO;var gO=function(){function P(P){this.G=_O,this.I=X,this.Z=jO,this.ondata=P}return P.prototype.push=function(P,U){if(!this.ondata)throw"no stream handler";var f,b;this.s?this.s.push(P,U):(this.p&&this.p.length?((f=new F(this.p.length+P.length)).set(this.p),f.set(P,this.p.length)):this.p=P,2<this.p.length&&((b=this).s=new(31==this.p[0]&&139==this.p[1]&&8==this.p[2]?this.G:8!=(15&this.p[0])||7<this.p[0]>>4||(this.p[0]<<8|this.p[1])%31?this.I:this.Z)(function(){b.ondata.apply(b,arguments)}),this.s.push(this.p,U),this.p=null))},P}(),U=(P.Decompress=gO,function(){function P(P){this.G=xO,this.I=hO,this.Z=aO,this.ondata=P}return P.prototype.push=function(P,U){gO.prototype.push.call(this,P,U)},P}());function HO(P,U,f){if(f||(f=U,U={}),"function"!=typeof f)throw"no callback";return(31==P[0]&&139==P[1]&&8==P[2]?iO:8!=(15&P[0])||7<P[0]>>4||(P[0]<<8|P[1])%31?nO:MO)(P,U,f)}function FO(P,U){return(31==P[0]&&139==P[1]&&8==P[2]?wO:8!=(15&P[0])||7<P[0]>>4||(P[0]<<8|P[1])%31?A:kO)(P,U)}P.AsyncDecompress=U,P.decompress=HO,P.decompressSync=FO;var BO=function(P,U,f,b){for(var r in P){var K=P[r],r=U+r;K instanceof F?f[r]=[K,b]:Array.isArray(K)?f[r]=[K[0],i(b,K[1])]:BO(K,r+"/",f,b)}},cO="undefined"!=typeof TextEncoder&&new TextEncoder,yO="undefined"!=typeof TextDecoder&&new TextDecoder,VO=0;try{yO.decode(G,{stream:!0}),VO=1}catch(S){}function RO(P){for(var U="",f=0;;){var b=P[f++],r=(127<b)+(223<b)+(239<b);if(f+r>P.length)return[U,R(P,f-1)];r?3==r?(b=((15&b)<<18|(63&P[f++])<<12|(63&P[f++])<<6|63&P[f++])-65536,U+=String.fromCharCode(55296|b>>10,56320|1023&b)):U+=String.fromCharCode(1&r?(31&b)<<6|63&P[f++]:(15&b)<<12|(63&P[f++])<<6|63&P[f++]):U+=String.fromCharCode(b)}}U=function(){function P(P){this.ondata=P,VO?this.t=new TextDecoder:this.p=G}return P.prototype.push=function(P,U){if(!this.ondata)throw"no callback";if(U=!!U,this.t){if(this.ondata(this.t.decode(P,{stream:!0}),U),U){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var f=new F(this.p.length+P.length),P=(f.set(this.p),f.set(P,this.p.length),RO(f)),f=P[0],P=P[1];if(U){if(P.length)throw"invalid utf-8 data";this.p=null}else this.p=P;this.ondata(f,U)}},P}(),P.DecodeUTF8=U,U=function(){function P(P){this.ondata=P}return P.prototype.push=function(P,U){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata($(P),this.d=U||!1)},P}();function $(P,U){if(U){for(var f=new F(P.length),b=0;b<P.length;++b)f[b]=P.charCodeAt(b);return f}if(cO)return cO.encode(P);for(var r=P.length,K=new F(P.length+(P.length>>1)),u=0,N=function(P){K[u++]=P},b=0;b<r;++b){u+5>K.length&&((s=new F(u+8+(r-b<<1))).set(K),K=s);var s=P.charCodeAt(b);s<128||U?N(s):(s<2048?N(192|s>>6):(55295<s&&s<57344?(N(240|(s=65536+(1047552&s)|1023&P.charCodeAt(++b))>>18),N(128|s>>12&63)):N(224|s>>12),N(128|s>>6&63)),N(128|63&s))}return R(K,0,u)}function GO(P,U){if(U){for(var f="",b=0;b<P.length;b+=16384)f+=String.fromCharCode.apply(null,P.subarray(b,b+16384));return f}if(yO)return yO.decode(P);U=RO(P);if(U[1].length)throw"invalid utf-8 data";return U[0]}P.EncodeUTF8=U,P.strToU8=$,P.strFromU8=GO;function dO(P){return 1==P?3:P<6?2:9==P?1:0}function DO(P,U){return U+30+I(P,U+26)+I(P,U+28)}function Pg(P,U,f){var b=I(P,U+28),r=GO(P.subarray(U+46,U+46+b),!(2048&I(P,U+8))),b=U+46+b,K=W(P,U+20),f=f&&4294967295==K?fg(P,b):[K,W(P,U+24),W(P,U+42)],K=f[0],u=f[1],f=f[2];return[I(P,U+10),K,u,r,b+I(P,U+30)+I(P,U+32),f]}function h(P){var U=0;if(P)for(var f in P){f=P[f].length;if(65535<f)throw"extra field too long";U+=f+4}return U}function n(P,U,f,b,r,K,u,N){var s=b.length,p=f.extra,T=N&&N.length,E=h(p),r=(o(P,U,null!=u?33639248:67324752),U+=4,null!=u&&(P[U++]=20,P[U++]=f.os),P[U]=20,U+=2,P[U++]=f.flag<<1|(null==K&&8),P[U++]=r&&8,P[U++]=255&f.compression,P[U++]=f.compression>>8,new Date(null==f.mtime?Date.now():f.mtime)),X=r.getFullYear()-1980;if(X<0||119<X)throw"date not in range 1980-2099";if(o(P,U,X<<25|r.getMonth()+1<<21|r.getDate()<<16|r.getHours()<<11|r.getMinutes()<<5|r.getSeconds()>>>1),U+=4,null!=K&&(o(P,U,f.crc),o(P,U+4,K),o(P,U+8,f.size)),o(P,U+12,s),o(P,U+14,E),U+=16,null!=u&&(o(P,U,T),o(P,U+6,f.attrs),o(P,U+10,u),U+=14),P.set(b,U),U+=s,E)for(var Y in p){var S=p[Y],A=S.length;o(P,U,+Y),o(P,U+2,A),P.set(S,U+4),U+=4+A}T&&(P.set(N,U),U+=T)}function Ug(P,U,f,b,r){o(P,U,101010256),o(P,U+8,f),o(P,U+10,f),o(P,U+12,b),o(P,U+16,r)}var fg=function(P,U){for(;1!=I(P,U);U+=4+I(P,U+2));return[oO(P,U+12),oO(P,U+4),oO(P,U+20)]},bg=function(){function P(P){this.filename=P,this.c=L(),this.size=0,this.compression=0}return P.prototype.process=function(P,U){this.ondata(null,P,U)},P.prototype.push=function(P,U){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(P),this.size+=P.length,U&&(this.crc=this.c.d()),this.process(P,U||!1)},P}(),U=(P.ZipPassThrough=bg,function(){function P(P,U){var f=this;U=U||{},bg.call(this,P),this.d=new E(U,function(P,U){f.ondata(null,P,U)}),this.compression=8,this.flag=dO(U.level)}return P.prototype.process=function(P,U){try{this.d.push(P,U)}catch(P){this.ondata(P,null,U)}},P.prototype.push=function(P,U){bg.prototype.push.call(this,P,U)},P}()),U=(P.ZipDeflate=U,function(){function P(P,U){var b=this;U=U||{},bg.call(this,P),this.d=new QO(U,function(P,U,f){b.ondata(P,U,f)}),this.compression=8,this.flag=dO(U.level),this.terminate=this.d.terminate}return P.prototype.process=function(P,U){this.d.push(P,U)},P.prototype.push=function(P,U){bg.prototype.push.call(this,P,U)},P}()),U=(P.AsyncZipDeflate=U,function(){function P(P){this.ondata=P,this.u=[],this.d=1}return P.prototype.add=function(b){var r=this;if(2&this.d)throw"stream finished";var P=$(b.filename),U=P.length,f=b.comment,K=f&&$(f),f=U!=b.filename.length||K&&f.length!=K.length,u=U+h(b.extra)+30;if(65535<U)throw"filename too long";function N(){for(var P=0,U=s;P<U.length;P++)r.ondata(null,U[P],!1);s=[]}var U=new F(u),s=(n(U,0,b,P,f),[U]),p=this.d,T=(this.d=0,this.u.length),E=i(b,{f:P,u:f,o:K,t:function(){b.terminate&&b.terminate()},r:function(){var P;N(),p&&((P=r.u[T+1])?P.r():r.d=1),p=1}}),X=0;b.ondata=function(P,U,f){P?(r.ondata(P,U,f),r.terminate()):(X+=U.length,s.push(U),f?(P=new F(16),o(P,0,134695760),o(P,4,b.crc),o(P,8,X),o(P,12,b.size),s.push(P),E.c=X,E.b=u+X+16,E.crc=b.crc,E.size=b.size,p&&E.r(),p=1):p&&N())},this.u.push(E)},P.prototype.end=function(){var P=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&P.d&&(P.u.splice(-1,1),P.e())},t:function(){}}),this.d=3},P.prototype.e=function(){for(var P=0,U=0,f=0,b=0,r=this.u;b<r.length;b++)f+=46+(K=r[b]).f.length+h(K.extra)+(K.o?K.o.length:0);for(var K,u=new F(f+22),N=0,s=this.u;N<s.length;N++)n(u,P,K=s[N],K.f,K.u,K.c,U,K.o),P+=46+K.f.length+h(K.extra)+(K.o?K.o.length:0),U+=K.b;Ug(u,P,this.u.length,f,U),this.ondata(null,u,!0),this.d=2},P.prototype.terminate=function(){for(var P=0,U=this.u;P<U.length;P++)U[P].t();this.d=2},P}());function rg(P,U,A){if(A||(A=U,U={}),"function"!=typeof A)throw"no callback";function o(){for(var P=0;P<Q.length;++P)Q[P]()}function t(){for(var P=new F(v+22),U=W,f=v-W,b=v=0;b<s;++b){var r=C[b];try{var K=r.c.length,u=(n(P,v,r,r.f,r.u,K),30+r.f.length+h(r.extra)),N=v+u;P.set(r.c,N),n(P,W,r,r.f,r.u,K,v,r.m),W+=16+u+(r.m?r.m.length:0),v=N+K}catch(P){return A(P,null)}}Ug(P,W,C.length,f,U),A(null,P)}var e={},O=(BO(P,"",e,U),pg.keys(e)),I=O.length,W=0,v=0,s=I,C=Array(I),Q=[];I||t();for(var f=0;f<s;++f)!function(f){function P(P,U){P?(o(),A(P,null)):(P=U.length,C[f]=i(K,{size:N,crc:u.d(),c:U,f:s,m:E,u:p!=b.length||E&&T.length!=X,compression:S}),W+=30+p+Y+P,v+=76+2*(p+Y)+(X||0)+P,--I||t())}var b=O[f],U=e[b],r=U[0],K=U[1],u=L(),N=r.length,s=(u.p(r),$(b)),p=s.length,T=K.comment,E=T&&$(T),X=E&&E.length,Y=h(K.extra),S=0==K.level?0:8;if(65535<p&&P("filename too long",null),S)if(N<16e4)try{P(null,$O(r,K))}catch(f){P(f,null)}else Q.push(LO(r,K,P));else P(null,r)}(f);return o}function Kg(P,U){var f,b={},r=[],K=(BO(P,"",b,U=U||{}),0),u=0;for(f in b){var N=b[f],s=N[0],N=N[1],p=0==N.level?0:8,T=(I=$(f)).length,E=N.comment,X=E&&$(E),Y=X&&X.length,S=h(N.extra);if(65535<T)throw"filename too long";var A=p?$O(s,N):s,o=A.length,t=L();t.p(s),r.push(i(N,{size:s.length,crc:t.d(),c:A,f:I,m:X,u:T!=f.length||X&&E.length!=Y,o:K,compression:p})),K+=30+T+S+o,u+=76+2*(T+S)+(Y||0)+o}for(var e=new F(u+22),P=K,U=u-K,O=0;O<r.length;++O){n(e,(I=r[O]).o,I,I.f,I.u,I.c.length);var I,W=30+I.f.length+h(I.extra);e.set(I.c,I.o+W),n(e,K,I,I.f,I.u,I.c.length,I.o,I.m),K+=16+W+(I.m?I.m.length:0)}return Ug(e,K,r.length,U,P),e}P.Zip=U,P.zip=rg,P.zipSync=Kg;var ug=function(){function P(){}return P.prototype.push=function(P,U){this.ondata(null,P,U)},P.compression=0,P}(),U=(P.UnzipPassThrough=ug,function(){function P(){var f=this;this.i=new X(function(P,U){f.ondata(null,P,U)})}return P.prototype.push=function(U,f){try{this.i.push(U,f)}catch(P){this.ondata(P,U,f)}},P.compression=8,P}()),U=(P.UnzipInflate=U,function(){function P(P,U){var b=this;U<32e4?this.i=new X(function(P,U){b.ondata(null,P,U)}):(this.i=new hO(function(P,U,f){b.ondata(P,U,f)}),this.terminate=this.i.terminate)}return P.prototype.push=function(P,U){this.i.terminate&&(P=R(P,0)),this.i.push(P,U)},P.compression=8,P}()),U=(P.AsyncUnzipInflate=U,function(){function P(P){this.onfile=P,this.k=[],this.o={0:ug},this.p=G}return P.prototype.push=function(P,U){var X=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(0<this.c){var f=Math.min(this.c,P.length),b=P.subarray(0,f);if(this.c-=f,this.d?this.d.push(b,!this.c):this.k[0].push(b),(P=P.subarray(f)).length)return this.push(P,U)}else{var Y=0,S=0,A=void 0,o=void 0;this.p.length?P.length?((o=new F(this.p.length+P.length)).set(this.p),o.set(P,this.p.length)):o=this.p:o=P;for(var t=o.length,e=this.c,b=e&&this.d,O=this;S<t-4&&"break"!==function(){var b,P,U,f,r,K,u,N,s,p,T,E=W(o,S);return 67324752==E?(Y=1,A=S,O.d=null,O.c=0,U=I(o,S+6),b=I(o,S+8),P=2048&U,U=8&U,f=I(o,S+26),r=I(o,S+28),S+30+f+r<t&&(O.k.unshift(K=[]),Y=2,N=W(o,S+18),s=W(o,S+22),p=GO(o.subarray(S+30,S+=30+f),!P),4294967295==N?(f=U?[-2]:fg(o,S),N=f[0],s=f[1]):U&&(N=-1),S+=r,O.c=N,T={name:p,compression:b,start:function(){if(!T.ondata)throw"no callback";if(N){var P=X.o[b];if(!P)throw"unknown compression type "+b;(u=N<0?new P(p):new P(p,N,s)).ondata=function(P,U,f){T.ondata(P,U,f)};for(var U=0,f=K;U<f.length;U++)u.push(f[U],!1);X.k[0]==K&&X.c?X.d=u:u.push(G,!0)}else T.ondata(null,G,!0)},terminate:function(){u&&u.terminate&&u.terminate()}},0<=N&&(T.size=N,T.originalSize=s),O.onfile(T)),"break"):e?134695760==E?(A=S+=12+(-2==e&&8),Y=3,O.c=0,"break"):33639248==E?(A=S-=4,Y=3,O.c=0,"break"):void 0:void 0}();++S);if(this.p=G,e<0&&(f=o.subarray(0,Y?A-12-(-2==e&&8)-(134695760==W(o,A-16)&&4):S),b?b.push(f,!!Y):this.k[+(2==Y)].push(f)),2&Y)return this.push(o.subarray(S),U);this.p=o.subarray(S)}if(U){if(this.c)throw"invalid zip file";this.p=null}},P.prototype.register=function(P){this.o[P.compression]=P},P}());function Ng(N,s){if("function"!=typeof s)throw"no callback";for(var p=[],T=function(){for(var P=0;P<p.length;++P)p[P]()},E={},P=N.length-22;101010256!=W(N,P);--P)if(!P||65558<N.length-P)return void s("invalid zip file",null);var X=I(N,P+8),U=(X||s(null,{}),X),Y=W(N,P+16),S=4294967295==Y;if(S){if(P=W(N,P-12),101075792!=W(N,P))return void s("invalid zip file",null);U=X=W(N,P+32),Y=W(N,P+48)}for(var f=0;f<U;++f)!function(){function U(P,U){P?(T(),s(P,null)):(E[K]=U,--X||s(null,E))}var P=Pg(N,Y,S),f=P[0],b=P[1],r=P[2],K=P[3],u=P[4],P=DO(N,P[5]);Y=u;if(f)if(8==f){u=N.subarray(P,P+b);if(b<32e4)try{U(null,A(u,new F(r)))}catch(P){U(P,null)}else p.push(nO(u,{size:r},U))}else U("unknown compression type "+f,null);else U(null,R(N,P,P+b))}();return T}function sg(P){for(var U={},f=P.length-22;101010256!=W(P,f);--f)if(!f||65558<P.length-f)throw"invalid zip file";var b=I(P,f+8);if(!b)return{};var r=4294967295==(X=W(P,f+16));if(r){if(f=W(P,f-12),101075792!=W(P,f))throw"invalid zip file";b=W(P,f+32),X=W(P,f+48)}for(var K=0;K<b;++K){var u=Pg(P,X,r),N=u[0],s=u[1],p=u[2],T=u[3],E=u[4],u=DO(P,u[5]),X=E;if(N){if(8!=N)throw"unknown compression type "+N;U[T]=A(P.subarray(u,u+s),new F(p))}else U[T]=R(P,u,u+s)}return U}return P.Unzip=U,P.unzip=Ng,P.unzipSync=sg,P}(),UO=function(P,U){this.textureLoader=P,this.manager=U},fO=(P(UO,pg,{_zS:function(P){P=P||{},s=[],l=this._AS();var U=this._BS(),U=this._CS(U,P),U=this._DS(U),f=this._ES(),b=(new pO)._zS(f);return this._FS(f,b,U,P),p.externalAssetURIs=s,p},_AS:function(){var r=new Map;return"Connections"in X&&X.Connections.connections.forEach(function(P){var U=P[0],f=P[1],P=P[2],b=(r.has(U)||r.set(U,{parents:[],children:[]}),{ID:f,relationship:P}),b=(r.get(U).parents.push(b),r.has(f)||r.set(f,{parents:[],children:[]}),{ID:U,relationship:P});r.get(f).children.push(b)}),r},_BS:function(){var P={},U={};if("Video"in X.Objects){var f,b=X.Objects.Video;for(f in b){var r,K,u,N=b[f];P[r=parseInt(f)]=N.RelativeFilename||N.Filename,"Content"in N&&(u=N.Content instanceof ArrayBuffer&&0<N.Content.byteLength,K="string"==typeof N.Content&&""!==N.Content,(u||K)&&(u=this._lS(b[f]),U[N.RelativeFilename||N.Filename]=u))}}for(r in P){var s=P[r];U[s]!==W?P[r]=U[s]:P[r]=P[r].split("\\").pop()}return P},_lS:function(P){var U,f=P.Content,b=P.RelativeFilename||P.Filename,r=b.slice(b.lastIndexOf(".")+1).toLowerCase();switch(r){case"bmp":U="image/bmp";break;case"jpg":case"jpeg":U="image/jpeg";break;case"png":U="image/png";break;case"tif":U="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",b),U="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}return"string"==typeof f?"data:"+U+";base64,"+f:(P=new Uint8Array(f),K.URL.createObjectURL(new Blob([P],{type:U})))},_CS:function(P,U){var f=new Map;if("Texture"in X.Objects){var b,r=X.Objects.Texture;for(b in r){var K=this.parseTexture(r[b],P,U);f.set(parseInt(b),K)}}return f},parseTexture:function(P,U,f){var b,r,P=l.get(P.id).children;if(P!==W&&0<P.length&&U[P[0].ID]!==W&&(0===(r=U[P[0].ID]).indexOf("blob:")||0===r.indexOf("data:")))return(U=new Image).src=r,b=new R({image:U,dynamic:!0}),U.onload=function(){delete b.dynamic},b;return r&&(r=r.match(/[^\\/]*$/)[0],s.indexOf(r)<0&&s.push(r),f.assetsURIMap&&f.assetsURIMap[r]?r=f.assetsURIMap[r]:f.path&&(r=f.path+r)),r},_DS:function(P){var U=new Map;if("Material"in X.Objects){var f,b=X.Objects.Material;for(f in b){var r=this._kS(b[f],P);null!==r&&U.set(parseInt(f),r)}}return U},_kS:function(P,U){var f=P.id,b=P.attrName,r=P.ShadingModel;if("object"==typeof r&&r.value,!l.has(f))return null;r=this._gS(P,U,f),P=new Z;return P.setValues(r),P.name=b,P},_gS:function(P,U,f){var b,r,K={},u=(P.BumpFactor&&(K.bumpScale=P.BumpFactor.value),P.Diffuse?K.diffuse=P.Diffuse.value:!P.DiffuseColor||"Color"!==P.DiffuseColor.type&&"ColorRGB"!==P.DiffuseColor.type||(K.diffuse=P.DiffuseColor.value),P.DisplacementFactor&&(K.displacementScale=P.DisplacementFactor.value),P.Emissive?K.emissive=P.Emissive.value:!P.EmissiveColor||"Color"!==P.EmissiveColor.type&&"ColorRGB"!==P.EmissiveColor.type||(K.emissive=P.EmissiveColor.value),P.EmissiveFactor&&1!==(b=parseFloat(P.EmissiveFactor.value))&&(r=K.emissive)!==W&&(r=Y.Default.getInternal().toColorArray(r),K.emissive=[r[0]*b,r[1]*b,r[2]*b]),P.Opacity&&(K.opacity=parseFloat(P.Opacity.value)),K.opacity<1&&(K.transparent=!0),P.ReflectionFactor&&(K.envMapIntensity=P.ReflectionFactor.value),P.Shininess&&(K.shininess=P.Shininess.value),P.Specular?K.specular=P.Specular.value:P.SpecularColor&&"Color"===P.SpecularColor.type&&(K.specular=P.SpecularColor.value),this);return l.get(f).children.forEach(function(P){switch(P.relationship){case"Bump":K.bumpMap=u._HS(U,P.ID);break;case"Maya|TEX_ao_map":K.aoMap=u._HS(U,P.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":K.map=u._HS(U,P.ID);break;case"DisplacementColor":K.displacementMap=u._HS(U,P.ID);break;case"EmissiveColor":K.emissiveMap=u._HS(U,P.ID);break;case"NormalMap":case"Maya|TEX_normal_map":K.normalMap=u._HS(U,P.ID);break;case"ReflectionColor":K.envMap=u._HS(U,P.ID);break;case"SpecularColor":K.specularMap=u._HS(U,P.ID);break;case"TransparentColor":case"TransparencyFactor":K.alphaMap=u._HS(U,P.ID),K.transparent=!0}}),K},_HS:function(P,U){return"LayeredTexture"in X.Objects&&U in X.Objects.LayeredTexture&&(console.warn("layered textures are not supported."),U=l.get(U).children[0].ID),P.get(U)},_ES:function(){var P={},U={};if("Deformer"in X.Objects){var f,b=X.Objects.Deformer;for(f in b){var r,K=b[f],u=l.get(parseInt(f));"Skin"===K.attrType?((r=this._mS(u,b)).ID=f,1<u.parents.length&&console.warn("skeleton attached to more than one geometry is not supported."),r.geometryID=u.parents[0].ID,P[f]=r):"BlendShape"===K.attrType&&((r={id:f}).rawTargets=this._nS(u,b),r.id=f,1<u.parents.length&&console.warn("morph target attached to more than one geometry is not supported."),U[f]=r)}}return{skeletons:P,morphTargets:U}},_mS:function(P,f){var b=[];return P.children.forEach(function(P){var U=f[P.ID];"Cluster"===U.attrType&&(P={ID:P.ID,indices:[],weights:[],transformLink:(new e).fromArray(U.TransformLink.a)},"Indexes"in U&&(P.indices=U.Indexes.a,P.weights=U.Weights.a),b.push(P))}),{rawBones:b,bones:[]}},_nS:function(P,U){for(var f=[],b=0;b<P.children.length;b++){var r=P.children[b],K=U[r.ID],u={name:K.attrName,initialWeight:K.DeformPercent,id:K.id,fullWeights:K.FullWeights.a};if("BlendShapeChannel"!==K.attrType)return;u.geoID=l.get(parseInt(r.ID)).children.filter(function(P){return P.relationship===W})[0].ID,f.push(u)}return f},_FS:function(P,U,f,b){p=new h;var r=this._oS(P.skeletons,U,f),K=X.Objects.Model,u=this;r.forEach(function(U){var P=K[U.ID],P=(u._IS(U,P),l.get(U.ID));P&&(P.parents.forEach(function(P){P=r.get(P.ID);P!==W&&P.add(U)}),null==U.getParent()&&p.add(U))}),this._JS(P.skeletons,U,r),p.traverse(function(P){var U,f=P.userData.transformData;f&&((U=P.getParent())&&(f.parentMatrix=U.matrix,f.parentMatrixWorld=U.matrixWorld),U=F(f),P.applyMatrix4(U))}),p.materialMap=f,p.animations=(new TO)._zS(b)},_oS:function(P,U,f){var b,r=new Map,K=X.Objects.Model;for(b in K){var u=parseInt(b),N=K[b],s=l.get(u),p=s?this._pS(s,P,u,N.attrName):null;p||((p="Mesh"===N.attrType?this._sS(s,U,f):new h).name=N.attrName?T(N.attrName):"",N.uid||(N.uid=Y.Math.generateIncreasingID()),p.uid=N.uid,p.ID=u),this._uS(p,N),r.set(u,p)}return r},_pS:function(P,U,r,K){var u=null;return P.parents.forEach(function(f){for(var P in U){var b=U[P];b.rawBones.forEach(function(P,U){P.ID===f.ID&&((u=new h).isBone=!0,u.matrixWorld.copy(P.transformLink),u.name=K?T(K):"",u.ID=r,b.bones[U]=u)})}}),u},_rS:function(P){var U,f;if(P.children.forEach(function(P){P=X.Objects.NodeAttribute[P.ID];P!==W&&(f=P)}),f===W)U=new Object3D;else{var P=f.LightType===W?0:f.LightType.value,b=16777215,r=(f.Color!==W&&(b=(new Color).fromArray(f.Color.value)),f.Intensity===W?1:f.Intensity.value/100),K=(f.CastLightOnObject!==W&&0===f.CastLightOnObject.value&&(r=0),0);f.FarAttenuationEnd!==W&&(K=f.EnableFarAttenuation!==W&&0===f.EnableFarAttenuation.value?0:f.FarAttenuationEnd.value);switch(P){case 0:U=new PointLight(b,r,K,1);break;case 1:U=new DirectionalLight(b,r);break;case 2:var u=Math.PI/3,N=(f.InnerAngle!==W&&(u=I(f.InnerAngle.value)),0);f.OuterAngle!==W&&(N=I(f.OuterAngle.value),N=Math.max(N,1)),U=new SpotLight(b,r,K,u,N,1);break;default:console.warn("Unknown light type "+f.LightType.value+", defaulting to a PointLight."),U=new PointLight(b,r)}f.CastShadows!==W&&1===f.CastShadows.value&&(U.castShadow=!0)}return U},_sS:function(P,U,f){var b=null,r=null,K=[];return P.children.forEach(function(P){U.has(P.ID)&&(b=U.get(P.ID)),f.has(P.ID)&&K.push(f.get(P.ID))}),r=1<K.length?K:1==K.length?K[0]:((P=f.has(-1))||(P=(new Z).setValues({name:"__missing__"}),f.set(-1,P)),P),b.FBX_Deformer,(P=new N(b,r)).normalizeSkinWeights(),P},_tS:function(P,U){},_uS:function(P,U){var f={};"InheritType"in U&&(f.inheritType=parseInt(U.InheritType.value)),"RotationOrder"in U?f.eulerOrder=q(U.RotationOrder.value):f.eulerOrder="ZYX","Lcl_Translation"in U&&(f.translation=U.Lcl_Translation.value),"PreRotation"in U&&(f.preRotation=U.PreRotation.value),"Lcl_Rotation"in U&&(f.rotation=U.Lcl_Rotation.value),"PostRotation"in U&&(f.postRotation=U.PostRotation.value),"Lcl_Scaling"in U&&(f.scale=U.Lcl_Scaling.value),"ScalingOffset"in U&&(f.scalingOffset=U.ScalingOffset.value),"ScalingPivot"in U&&(f.scalingPivot=U.ScalingPivot.value),"RotationOffset"in U&&(f.rotationOffset=U.RotationOffset.value),"RotationPivot"in U&&(f.rotationPivot=U.RotationPivot.value),P.userData.transformData=f},_IS:function(f,P){"LookAtProperty"in P&&l.get(f.ID).children.forEach(function(P){var U;"LookAtProperty"===P.relationship&&"Lcl_Translation"in(P=X.Objects.Model[P.ID])&&(P=P.Lcl_Translation.value,f.target!==W?(f.target.matrix.setPosition({x:P[0],y:P[1],z:P[2]}),p.add(f.target)):(U=f.matrix.getPosition(),f.matrix.lookAt({x:P[0],y:P[1],z:P[2]},U)))})},_JS:function(P,U,f){var b,r=this._KS();for(b in P){var K=P[b];l.get(parseInt(K.ID)).parents.forEach(function(P){U.has(P.ID)&&(P=P.ID,l.get(P).parents.forEach(function(P){f.has(P.ID)&&(f.get(P.ID).skeleton=[K.bones,function(P){for(var U=[],f=new e,b=0,r=P.length;b<r;b++)f.copy(P[b].matrixWorld).invert().toArray(U,16*b);return U}(K.bones),r[P.ID]||new e])}))})}},_KS:function(){var U={};if("Pose"in X.Objects){var P,f,b=X.Objects.Pose;for(P in b)"BindPose"===b[P].attrType&&(f=b[P].PoseNode,Array.isArray(f)?f.forEach(function(P){U[P.Node]=(new e).fromArray(P.Matrix.a)}):U[f.Node]=(new e).fromArray(f.Matrix.a))}return U},_LS:function(){var P,U,f;"GlobalSettings"in X&&"AmbientColor"in X.GlobalSettings&&(f=(U=X.GlobalSettings.AmbientColor.value)[0],P=U[1],U=U[2],0===f&&0===P&&0===U||(f=new Color(f,P,U),p.add(new AmbientLight(f,1))))}}),new Y.Math.Matrix4);function z(P,U,f){this.name="",this.array=P,this.itemSize=U,this.count=P!==W?P.length/U:0,this.normalized=!0===f,this.usage=Y.WebGLConstants.STATIC_DRAW,this.updateRange={offset:0,count:-1},this.version=0}P(n,pg,{_3s:function(P){return Array.isArray(P)?this.index=new(65535<arrayMax(P)?U:x)(P,1):this.index=P,this},_4s:function(P,U){return this.attributes[P]=U,this},_5s:function(P){return delete this.attributes[P],this},_6s:function(P){return this.attributes[P]!==W},applyMatrix4:function(P){var U=this.attributes.position,U=(U!==W&&(U.applyMatrix4(P),U.needsUpdate=!0),this.attributes.normal),f=(U!==W&&(f=(new Y.Math.Matrix3).getNormalMatrix(P),U.applyNormalMatrix(f),U.needsUpdate=!0),this.attributes.tangent);return f!==W&&(f.transformDirection(P),f.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},applyQuaternion:function(P){return fO.makeRotationFromQuaternion(P),this.applyMatrix4(fO),this},_MS:function(P,U,f){this.groups.push({start:P,count:U,materialIndex:f||0})},setFromPoints:function(P){for(var U=[],f=0,b=P.length;f<b;f++){var r=P[f];U.push(r.x,r.y,r.z||0)}return this._4s("position",new i(U,3)),this}}),pg.defineProperty(z.prototype,"needsUpdate",{set:function(P){!0===P&&this.version++}});var _=new O;function bO(P,U,f){z.call(this,new Int8Array(P),U,f)}function rO(P,U,f){z.call(this,new Uint8Array(P),U,f)}function KO(P,U,f){z.call(this,new Uint8ClampedArray(P),U,f)}function uO(P,U,f){z.call(this,new Int16Array(P),U,f)}function x(P,U,f){z.call(this,new Uint16Array(P),U,f)}function NO(P,U,f){z.call(this,new Int32Array(P),U,f)}function U(P,U,f){z.call(this,new Uint32Array(P),U,f)}function i(P,U,f){z.call(this,new Float32Array(P),U,f)}function sO(P,U,f){z.call(this,new Float64Array(P),U,f)}pg.assign(z.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(P){return this.usage=P,this},copy:function(P){return this.name=P.name,this.array=new P.array.constructor(P.array),this.itemSize=P.itemSize,this.count=P.count,this.normalized=P.normalized,this.usage=P.usage,this},_8s:function(P,U,f){P*=this.itemSize,f*=U.itemSize;for(var b=0,r=this.itemSize;b<r;b++)this.array[P+b]=U.array[f+b];return this},_9s:function(P){return this.array.set(P),this},copyColorsArray:function(P){for(var U=this.array,f=0,b=0,r=P.length;b<r;b++){var K=P[b];K===W?(U[f++]=1,U[f++]=1,U[f++]=1):(U[f++]=K.r,U[f++]=K.g,U[f++]=K.b)}return this},_7s:function(P){for(var U=this.array,f=0,b=0,r=P.length;b<r;b++){var K=P[b];K===W&&(K=new Vector2),U[f++]=K.x,U[f++]=K.y}return this},_as:function(P){for(var U=this.array,f=0,b=0,r=P.length;b<r;b++){var K=P[b];K===W&&(K=new O),U[f++]=K.x,U[f++]=K.y,U[f++]=K.z}return this},_bs:function(P){for(var U=this.array,f=0,b=0,r=P.length;b<r;b++){var K=P[b];K===W&&(K=new E),U[f++]=K.x,U[f++]=K.y,U[f++]=K.z,U[f++]=K.w}return this},applyMatrix3:function(P){for(var U=0,f=this.count;U<f;U++)_.x=this.getX(U),_.y=this.getY(U),_.z=this.getZ(U),_.applyMatrix3(P),this.setXYZ(U,_.x,_.y,_.z);return this},applyMatrix4:function(P){for(var U=0,f=this.count;U<f;U++)_.x=this.getX(U),_.y=this.getY(U),_.z=this.getZ(U),_.applyMatrix4(P),this.setXYZ(U,_.x,_.y,_.z);return this},applyNormalMatrix:function(P){for(var U=0,f=this.count;U<f;U++)_.x=this.getX(U),_.y=this.getY(U),_.z=this.getZ(U),_.applyNormalMatrix(P),this.setXYZ(U,_.x,_.y,_.z);return this},transformDirection:function(P){for(var U=0,f=this.count;U<f;U++)_.x=this.getX(U),_.y=this.getY(U),_.z=this.getZ(U),_.transformDirection(P),this.setXYZ(U,_.x,_.y,_.z);return this},set:function(P,U){return this.array.set(P,U=U===W?0:U),this},getX:function(P){return this.array[P*this.itemSize]},setX:function(P,U){return this.array[P*this.itemSize]=U,this},getY:function(P){return this.array[P*this.itemSize+1]},setY:function(P,U){return this.array[P*this.itemSize+1]=U,this},getZ:function(P){return this.array[P*this.itemSize+2]},setZ:function(P,U){return this.array[P*this.itemSize+2]=U,this},getW:function(P){return this.array[P*this.itemSize+3]},setW:function(P,U){return this.array[P*this.itemSize+3]=U,this},setXY:function(P,U,f){return P*=this.itemSize,this.array[P+0]=U,this.array[P+1]=f,this},setXYZ:function(P,U,f,b){return P*=this.itemSize,this.array[P+0]=U,this.array[P+1]=f,this.array[P+2]=b,this},setXYZW:function(P,U,f,b,r){return P*=this.itemSize,this.array[P+0]=U,this.array[P+1]=f,this.array[P+2]=b,this.array[P+3]=r,this},onUpload:function(P){return this.onUploadCallback=P,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(bO.prototype=pg.create(z.prototype)).constructor=bO,(rO.prototype=pg.create(z.prototype)).constructor=rO,(KO.prototype=pg.create(z.prototype)).constructor=KO,(uO.prototype=pg.create(z.prototype)).constructor=uO,x.prototype=pg.create(z.prototype),x.prototype.constructor=x,(NO.prototype=pg.create(z.prototype)).constructor=NO,U.prototype=pg.create(z.prototype),U.prototype.constructor=U,(i.prototype=pg.create(z.prototype)).constructor=i,(sO.prototype=pg.create(z.prototype)).constructor=sO;var pO=function(){},TO=(P(pO,pg,{_zS:function(P){var U=new Map;if("Geometry"in X.Objects){var f,b=X.Objects.Geometry;for(f in b){var r=l.get(parseInt(f)),r=this._2s(r,b[f],P);U.set(parseInt(f),r)}}return U},_2s:function(P,U,f){switch(U.attrType){case"Mesh":return this._1s(P,U,f);case"NurbsCurve":return this._PS(U)}},_1s:function(P,U,f){var b,r=f.skeletons,K=[],u=P.parents.map(function(P){return X.Objects.Model[P.ID]});if(0!==u.length)return b=P.children.reduce(function(P,U){return P=r[U.ID]!==W?r[U.ID]:P},null),P.children.forEach(function(P){f.morphTargets[P.ID]!==W&&K.push(f.morphTargets[P.ID])}),P=u[0],u={},"RotationOrder"in P&&(u.eulerOrder=q(P.RotationOrder.value)),"InheritType"in P&&(u.inheritType=parseInt(P.InheritType.value)),"GeometricTranslation"in P&&(u.translation=P.GeometricTranslation.value),"GeometricRotation"in P&&(u.rotation=P.GeometricRotation.value),"GeometricScaling"in P&&(u.scale=P.GeometricScaling.value),P=F(u),this._ZS(U,b,K,P)},_ZS:function(P,U,f,b){var r,K,u=new n,N=(P.attrName&&(u.name=P.attrName),this._YS(P,U)),s=this._XS(N),p=new i(s.vertex,3);return p.applyMatrix4(b),u._4s("position",p),0<s.colors.length&&u._4s("color",new i(s.colors,3)),U&&(u._4s("skinIndex",new x(s.weightsIndices,4)),u._4s("skinWeight",new i(s.vertexWeights,4)),u.FBX_Deformer=U),0<s.normal.length&&(p=(new Y.Math.Matrix3).getNormalMatrix(b),(U=new i(s.normal,3)).applyNormalMatrix(p),u._4s("normal",U)),s.uvs.forEach(function(P,U){var f="uv"+(U+1).toString();u._4s(f=0===U?"uv":f,new i(s.uvs[U],2))}),N.material&&"AllSame"!==N.material.mappingType&&(r=s.materialIndex[0],K=0,s.materialIndex.forEach(function(P,U){P!==r&&(u._MS(K,U-K,r),r=P,K=U)}),0<u.groups.length&&((U=(p=u.groups[u.groups.length-1]).start+p.count)!==s.materialIndex.length&&u._MS(U,s.materialIndex.length-U,r)),0===u.groups.length&&u._MS(0,s.materialIndex.length,s.materialIndex[0])),this._VS(u,P,f,b),u},_YS:function(P,U){var r={};if(r.vertexPositions=P.Vertices!==W?P.Vertices.a:[],r.vertexIndices=P.PolygonVertexIndex!==W?P.PolygonVertexIndex.a:[],P.LayerElementColor&&(r.color=this._RS(P.LayerElementColor[0])),P.LayerElementMaterial&&(r.material=this._QS(P.LayerElementMaterial[0])),P.LayerElementNormal&&(r.normal=this._TS(P.LayerElementNormal[0])),P.LayerElementUV){r.uv=[];for(var f=0;P.LayerElementUV[f];)P.LayerElementUV[f].UV&&r.uv.push(this._SS(P.LayerElementUV[f])),f++}return r.weightTable={},null!==U&&(r.skeleton=U).rawBones.forEach(function(f,b){f.indices.forEach(function(P,U){r.weightTable[P]===W&&(r.weightTable[P]=[]),r.weightTable[P].push({id:b,weight:f.weights[U]})})}),r},_XS:function(T){var E={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},X=0,Y=0,S=[],A=[],o=[],t=[],e=[],O=[],I=this;return T.vertexIndices.forEach(function(f,b){var P,K,u,U,r=!1,N=(f<0&&(f^=-1,r=!0),[]),s=[];if(S.push(3*f,3*f+1,3*f+2),T.color&&(U=L(b,X,f,T.color),o.push(U[0],U[1],U[2])),T.skeleton){for(T.weightTable[f]!==W&&T.weightTable[f].forEach(function(P){s.push(P.weight),N.push(P.id)}),4<s.length&&(K=[0,0,0,0],u=[0,0,0,0],s.forEach(function(P,U){var b=P,r=N[U];u.forEach(function(P,U,f){P<b&&(f[U]=b,b=P,f=K[U],K[U]=r,r=f)})}),N=K,s=u);s.length<4;)s.push(0),N.push(0);for(var p=0;p<4;++p)e.push(s[p]),O.push(N[p])}T.normal&&(U=L(b,X,f,T.normal),A.push(U[0],U[1],U[2])),T.material&&"AllSame"!==T.material.mappingType&&(P=L(b,X,f,T.material)[0]),T.uv&&T.uv.forEach(function(P,U){P=L(b,X,f,P);t[U]===W&&(t[U]=[]),t[U].push(P[0]),t[U].push(P[1])}),Y++,r&&(I._WS(E,T,S,P,A,o,t,e,O,Y),X++,Y=0,S=[],A=[],o=[],t=[],e=[],O=[])}),E},_WS:function(f,P,U,b,r,K,u,N,s,p){for(var T=2;T<p;T++)f.vertex.push(P.vertexPositions[U[0]]),f.vertex.push(P.vertexPositions[U[1]]),f.vertex.push(P.vertexPositions[U[2]]),f.vertex.push(P.vertexPositions[U[3*(T-1)]]),f.vertex.push(P.vertexPositions[U[3*(T-1)+1]]),f.vertex.push(P.vertexPositions[U[3*(T-1)+2]]),f.vertex.push(P.vertexPositions[U[3*T]]),f.vertex.push(P.vertexPositions[U[3*T+1]]),f.vertex.push(P.vertexPositions[U[3*T+2]]),P.skeleton&&(f.vertexWeights.push(N[0]),f.vertexWeights.push(N[1]),f.vertexWeights.push(N[2]),f.vertexWeights.push(N[3]),f.vertexWeights.push(N[4*(T-1)]),f.vertexWeights.push(N[4*(T-1)+1]),f.vertexWeights.push(N[4*(T-1)+2]),f.vertexWeights.push(N[4*(T-1)+3]),f.vertexWeights.push(N[4*T]),f.vertexWeights.push(N[4*T+1]),f.vertexWeights.push(N[4*T+2]),f.vertexWeights.push(N[4*T+3]),f.weightsIndices.push(s[0]),f.weightsIndices.push(s[1]),f.weightsIndices.push(s[2]),f.weightsIndices.push(s[3]),f.weightsIndices.push(s[4*(T-1)]),f.weightsIndices.push(s[4*(T-1)+1]),f.weightsIndices.push(s[4*(T-1)+2]),f.weightsIndices.push(s[4*(T-1)+3]),f.weightsIndices.push(s[4*T]),f.weightsIndices.push(s[4*T+1]),f.weightsIndices.push(s[4*T+2]),f.weightsIndices.push(s[4*T+3])),P.color&&(f.colors.push(K[0]),f.colors.push(K[1]),f.colors.push(K[2]),f.colors.push(K[3*(T-1)]),f.colors.push(K[3*(T-1)+1]),f.colors.push(K[3*(T-1)+2]),f.colors.push(K[3*T]),f.colors.push(K[3*T+1]),f.colors.push(K[3*T+2])),P.material&&"AllSame"!==P.material.mappingType&&(f.materialIndex.push(b),f.materialIndex.push(b),f.materialIndex.push(b)),P.normal&&(f.normal.push(r[0]),f.normal.push(r[1]),f.normal.push(r[2]),f.normal.push(r[3*(T-1)]),f.normal.push(r[3*(T-1)+1]),f.normal.push(r[3*(T-1)+2]),f.normal.push(r[3*T]),f.normal.push(r[3*T+1]),f.normal.push(r[3*T+2])),P.uv&&P.uv.forEach(function(P,U){f.uvs[U]===W&&(f.uvs[U]=[]),f.uvs[U].push(u[U][0]),f.uvs[U].push(u[U][1]),f.uvs[U].push(u[U][2*(T-1)]),f.uvs[U].push(u[U][2*(T-1)+1]),f.uvs[U].push(u[U][2*T]),f.uvs[U].push(u[U][2*T+1])})},_VS:function(f,b,P,r){var K;0!==P.length&&(f.morphTargetsRelative=!0,f.morphAttributes.position=[],K=this,P.forEach(function(P){P.rawTargets.forEach(function(P){var U=X.Objects.Geometry[P.geoID];U!==W&&K._US(f,b,U,r,P.name)})}))},_US:function(P,U,f,b,r){for(var U=U.PolygonVertexIndex!==W?U.PolygonVertexIndex.a:[],K=f.Vertices!==W?f.Vertices.a:[],u=f.Indexes!==W?f.Indexes.a:[],N=3*P.attributes.position.count,s=new Float32Array(N),p=0;p<u.length;p++){var T=3*u[p];s[T]=K[3*p],s[1+T]=K[3*p+1],s[2+T]=K[3*p+2]}N=new i(this._XS({vertexIndices:U,vertexPositions:s}).vertex,3);N.name=r||f.attrName,N.applyMatrix4(b),P.morphAttributes.position.push(N)},_TS:function(P){var U=P.MappingInformationType,f=P.ReferenceInformationType,b=P.Normals.a,r=[];return"IndexToDirect"===f&&("NormalIndex"in P?r=P.NormalIndex.a:"NormalsIndex"in P&&(r=P.NormalsIndex.a)),{dataSize:3,buffer:b,indices:r,mappingType:U,referenceType:f}},_SS:function(P){var U=P.MappingInformationType,f=P.ReferenceInformationType,b=[];return{dataSize:2,buffer:P.UV.a,indices:b="IndexToDirect"===f?P.UVIndex.a:b,mappingType:U,referenceType:f}},_RS:function(P){var U=P.MappingInformationType,f=P.ReferenceInformationType,b=[];return{dataSize:4,buffer:P.Colors.a,indices:b="IndexToDirect"===f?P.ColorIndex.a:b,mappingType:U,referenceType:f}},_QS:function(P){var U=P.MappingInformationType,f=P.ReferenceInformationType;if("NoMappingInformation"===U||!P.Materials)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:f};for(var b=P.Materials.a,r=[],K=0;K<b.length;++K)r.push(K);return{dataSize:1,buffer:b,indices:r,mappingType:U,referenceType:f}},_PS:function(P){if(XO===W)return console.error("The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new n;var U=parseInt(P.Order);if(isNaN(U))return console.error("Invalid Order %s given for geometry ID: %s",P.Order,P.id),new n;for(var f=U-1,U=P.KnotVector.a,b=[],r=P.Points.a,K=0,u=r.length;K<u;K+=4)b.push((new E).fromArray(r,K));if("Closed"===P.Form)b.push(b[0]);else if("Periodic"===P.Form)for(var N=f,s=U.length-1-N,K=0;K<f;++K)b.push(b[K]);P=new XO(f,U,b,N,s).getPoints(12*b.length);return(new n).setFromPoints(P)}}),function(){});function EO(P,U,f,b){for(var r=function(P,U,f){var b=f.length-P-1;if(U>=f[b])return b-1;if(U<=f[P])return P;for(var r=P,K=b,u=Math.floor((r+K)/2);U<f[u]||U>=f[u+1];)U<f[u]?K=u:r=u,u=Math.floor((r+K)/2);return u}(P,b,U),K=function(P,U,f,b){for(var r=[],K=[],u=[],N=r[0]=1;N<=f;++N){K[N]=U-b[P+1-N],u[N]=b[P+N]-U;for(var s=0,p=0;p<N;++p){var T=u[p+1],E=K[N-p],X=r[p]/(T+E);r[p]=s+T*X,s=E*X}r[N]=s}return r}(r,b,P,U),u=new E(0,0,0,0),N=0;N<=P;++N){var s=f[r-P+N],p=K[N],T=s.w*p;u.x+=s.x*T,u.y+=s.y*T,u.z+=s.z*T,u.w+=s.w*p}return u}P(TO,pg,{_zS:function(P){this.params=P;var U=[],f=this._qs();if(f!==W)for(var b in f){b=f[b],b=this._js(b);U.push(b)}return this.params=null,U},_qs:function(){if(X.Objects.AnimationCurve===W)return W;var P=this._ns(),P=(this._ms(P),this._ls(P));return this._ks(P)},_ns:function(){var P,U=X.Objects.AnimationCurveNode,f=new Map;for(P in U){var b=U[P];null!==b.attrName.match(/S|R|T|DeformPercent/)&&(b={id:b.id,attr:b.attrName,curves:{}},f.set(b.id,b))}return f},_ms:function(P){var U,f=X.Objects.AnimationCurve;for(U in f){var b,r={id:f[U].id,times:f[U].KeyTime.a.map(J),values:f[U].KeyValueFloat.a},K=l.get(r.id);K!==W&&(b=K.parents[0].ID,(K=K.parents[0].relationship).match(/X/)?P.get(b).curves.x=r:K.match(/Y/)?P.get(b).curves.y=r:K.match(/Z/)?P.get(b).curves.z=r:K.match(/d|DeformPercent/)&&P.has(b)&&(P.get(b).curves.morph=r))}},_ls:function(N){var P,U=X.Objects.AnimationLayer,f=new Map;for(P in U){var s=[],b=l.get(parseInt(P));b!==W&&(b.children.forEach(function(P,U){if(N.has(P.ID)){var f,b,r,K=N.get(P.ID);if(K.curves.x!==W||K.curves.y!==W||K.curves.z!==W){if(s[U]===W)if((b=l.get(P.ID).parents.filter(function(P){return P.relationship!==W})[0].ID)!==W){if((r=X.Objects.Model[b.toString()])===W)return;var u={modelName:r.attrName?T(r.attrName):"",ID:r.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};p.traverse(function(P){P.ID===r.id&&(u.transform=P.matrix,P.userData.transformData&&(u.eulerOrder=P.userData.transformData.eulerOrder))}),u.transform||(u.transform=new e),"PreRotation"in r&&(u.preRotation=r.PreRotation.value),"PostRotation"in r&&(u.postRotation=r.PostRotation.value),s[U]=u}s[U]&&(s[U][K.attr]=K)}else K.curves.morph!==W&&(s[U]===W&&(P=l.get(P.ID).parents.filter(function(P){return P.relationship!==W})[0].ID,f=l.get(P).parents[0].ID,f=l.get(f).parents[0].ID,b=l.get(f).parents[0].ID,u={modelName:(r=X.Objects.Model[b]).attrName?PropertyBinding.sanitizeNodeName(r.attrName):"",ID:r.id,morphName:X.Objects.Deformer[P].attrName},s[U]=u),s[U][K.attr]=K)}}),f.set(parseInt(P),s))}return f},_ks:function(P){var U,f=X.Objects.AnimationStack,b={};for(U in f){var r=l.get(parseInt(U)).children,r=P.get(r[0].ID);b[U]={name:f[U].attrName,layer:r}}return b},_js:function(P){var U=[],f=this,b=(P.layer.forEach(function(P){U=U.concat(f._ps(P))}),0);return U.forEach(function(P){b=Math.max(b,P.times[P.times.length-1])}),{name:P.name,duration:b,tracks:U}},_ps:function(P){var U=[],f=new O,b=new t,r=new O;return P.transform&&P.transform.decompose(f,b,r),f=f.toArray(),b=(new o).setFromQuaternion(b,P.eulerOrder).toArray(),r=r.toArray(),P.T!==W&&0<pg.keys(P.T.curves).length&&((f=this._hs(P.ID,P.T.curves,f,"position"))!==W&&U.push(f)),P.R!==W&&0<pg.keys(P.R.curves).length&&((f=this._gs(P.ID,P.R.curves,b,P.preRotation,P.postRotation,P.eulerOrder))!==W&&U.push(f)),P.S!==W&&0<pg.keys(P.S.curves).length&&((b=this._hs(P.ID,P.S.curves,r,"scale"))!==W&&U.push(b)),P.DeformPercent!==W&&(f=this._fs(P))!==W&&U.push(f),U},_hs:function(P,U,f,b){var r=this._es(U);return{type:"linear",name:P+"."+b,times:r,values:this._ds(r,U,f)}},_gs:function(P,U,f,b,r,K){U.x!==W&&(this._cs(U.x),U.x.values=U.x.values.map(I)),U.y!==W&&(this._cs(U.y),U.y.values=U.y.values.map(I)),U.z!==W&&(this._cs(U.z),U.z.values=U.z.values.map(I));for(var u=this._es(U),N=this._ds(u,U,f),s=(b!==W&&((b=b.map(I)).push(K),b=(new o).fromArray(b),b=(new t).setFromEuler(b)),r!==W&&((r=r.map(I)).push(K),r=(new o).fromArray(r),r=(new t).setFromEuler(r).inverse()),new t),p=new o,T=[],E=0;E<N.length;E+=3)p.set(N[E],N[E+1],N[E+2],K),s.setFromEuler(p),b!==W&&s.premultiply(b),r!==W&&s.multiply(r),s.toArray(T,E/3*4);return{type:"quaternion",name:P+".quaternion",times:u,values:T}},_fs:function(P){var U=P.DeformPercent.curves.morph,f=U.values.map(function(P){return P/100}),b=p.getObjectByName(P.modelName).morphTargetDictionary[P.morphName];return{type:"number",name:P.ID+".morphTargetInfluences["+b+"]",times:U.times,values:f}},_es:function(P){var U=[];if(P.x!==W&&(U=U.concat(P.x.times)),P.y!==W&&(U=U.concat(P.y.times)),1<(U=(U=P.z!==W?U.concat(P.z.times):U).sort(function(P,U){return P-U})).length){for(var f=1,b=U[0],r=1;r<U.length;r++){var K=U[r];K!==b&&(b=U[f]=K,f++)}U=U.slice(0,f)}return U},getInterpolatedKeyframeValues:function(P,U,f){for(var b=[],r=["x","y","z"],K=P.length,u=0;u<3;u++){var N=U[r[u]],s=f[u];if(N){var p,T=N.times,E=N.values,X=0;0!==T[0]&&(T=[0].concat(T),E=[s].concat(E));for(S=0;S<K;S++){for(var Y=P[S];X<T.length-1&&T[X+1]<Y;)X++;p=T[X+1]===T[X]?E[X]:(p=(Y-T[X])/(T[X+1]-T[X]),E[X]+(E[X+1]-E[X])*p),b[3*S+u]=p}}else for(var S=0;S<K;S++)b[3*S+u]=s}return b},_ds:function(P,U,f){if(this.params&&!1!==this.params.keyframeValuesInterpolation)return this.getInterpolatedKeyframeValues(P,U,f);var b=f,r=[],K=-1,u=-1,N=-1;return P.forEach(function(P){U.x&&(K=U.x.times.indexOf(P)),U.y&&(u=U.y.times.indexOf(P)),U.z&&(N=U.z.times.indexOf(P)),-1!==K?(P=U.x.values[K],r.push(P),b[0]=P):r.push(b[0]),-1!==u?(P=U.y.values[u],r.push(P),b[1]=P):r.push(b[1]),-1!==N?(P=U.z.values[N],r.push(P),b[2]=P):r.push(b[2])}),r},checkNeedInterpolate:function(f,P){function U(P){return Math.abs(f.values[P]-f.values[P-1])/(f.times[P]-f.times[P-1])}function b(P){var U=Math.abs(f.values[P]-f.values[P-1])%360;return(U=180<U?360-U:U)/(f.times[P]-f.times[P-1])}function r(P,U){return Math.max(P,U)/Math.min(P,U)}var K=1===P?2:P-1;return!(8<r(U(P),U(K))&&r(b(P),b(K))<1.2)},_cs:function(P){for(var U=1;U<P.values.length;U++){var f=P.values[U-1],b=P.values[U]-f,r=Math.abs(b);if(!(r<180)){var K=this.params?this.params.rotationInterpolation:W;if(!1!==K&&(!0===K||this.checkNeedInterpolate(P,U))){for(var K=r/179,u=b/K,N=f+u,r=P.times[U-1],s=(P.times[U]-r)/K,p=r+s,T=[],E=[];p<P.times[U];)T.push(p),p+=s,E.push(N),N+=u;P.times=c(P.times,U,T),P.values=c(P.values,U,E)}}}}});var XO=function(P,U,f,b,r){this.degree=P,this.knots=U,this._vs=[],this.startKnot=b||0,this.endKnot=r||this.knots.length-1;for(var K=0;K<f.length;++K){var u=f[K];this._vs[K]=new E(u.x,u.y,u.z,u.w)}this.getPoint=function(P,U){U=U||new O,P=this.knots[this.startKnot]+P*(this.knots[this.endKnot]-this.knots[this.startKnot]),P=EO(this.degree,this.knots,this._vs,P);return 1!==P.w&&P.divideScalar(P.w),U.set(P.x,P.y,P.z)},this.getPoints=function(P){P=P||5;for(var U=[],f=0;f<=P;f++)U.push(this.getPoint(f/P));return U}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);